{"ast":null,"code":"import { mapMutations } from 'vuex';\nimport axios from 'axios';\nexport default {\n  name: 'UserLogin',\n  props: {\n    msg: String\n  },\n\n  data() {\n    return {\n      loginData: {\n        number: null,\n        password: ''\n      }\n    };\n  },\n\n  methods: { ...mapMutations(['changeLogin']),\n\n    submit() {\n      this.$refs['loginForm'].validate(valid => {\n        if (valid) {\n          // let data = {'username':this.loginData.username,'password':this.loginData.password};\n          axios.post('http://localhost:8081/login', null, {\n            params: this.loginData\n          }) // axios.post('http://localhost:8081/login', this.loginData)\n          // {\n          //   // headers: {'Content-Type': 'application/json; charset=utf-8'},\n          //   params: this.loginData\n          // //   // username:this.loginData.username,\n          // //   // password:this.loginData.password\n          // })\n          // axios({\n          //   methods: \"post\",\n          //   url: 'http://localhost:8081/login',\n          //   headers: {'Content-Type': 'application/json; charset=utf-8'},\n          //   params: this.loginData\n          // })\n          .then(res => {\n            console.log(res);\n            alert('登陆成功');\n            this.userToken = 'Bearer ' + res.headers.token; // 将用户token保存到vuex中\n\n            this.changeLogin({\n              Authorization: this.userToken\n            }); //传参内容为一个对象\n\n            if (this.loginData.password == '123456') {\n              alert('初次登录，请重置密码');\n              this.$router.push({\n                path: \"/password\"\n              });\n            } else this.$router.push({\n              path: \"/student\"\n            });\n          }).catch(error => {\n            alert('账号或密码错误!!');\n            console.dir(error);\n          });\n        } else {\n          console.log('error submit');\n          return false;\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAsCA,SAASA,YAAT,QAA6B,MAA7B;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,eAAe;AACbC,MAAI,EAAE,WADO;AAEbC,OAAK,EAAE;AACLC,OAAG,EAAEC;AADA,GAFM;;AAKbC,MAAI,GAAG;AACL,WAAO;AACLC,eAAS,EAAE;AACTC,cAAM,EAAC,IADE;AAETC,gBAAQ,EAAC;AAFA;AADN,KAAP;AAMD,GAZY;;AAabC,SAAO,EAAE,EACN,GAAGV,YAAY,CAAC,CAAC,aAAD,CAAD,CADT;;AAEPW,UAAM,GAAG;AACP,WAAKC,KAAL,CAAW,WAAX,EAAwBC,QAAxB,CAAiCC,KAAI,IAAK;AACxC,YAAGA,KAAH,EAAU;AACR;AACAb,eAAK,CAACc,IAAN,CAAW,6BAAX,EAA0C,IAA1C,EAA+C;AAACC,kBAAM,EAAC,KAAKT;AAAb,WAA/C,EACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAbA,WAcCU,IAdD,CAcMC,GAAE,IAAK;AACXC,mBAAO,CAACC,GAAR,CAAYF,GAAZ;AACAG,iBAAK,CAAC,MAAD,CAAL;AACA,iBAAKC,SAAL,GAAiB,YAAYJ,GAAG,CAACK,OAAJ,CAAYC,KAAzC,CAHW,CAIX;;AACA,iBAAKC,WAAL,CAAiB;AAAEC,2BAAa,EAAE,KAAKJ;AAAtB,aAAjB,EALW,CAKyC;;AAGpD,gBAAG,KAAKf,SAAL,CAAeE,QAAf,IAA2B,QAA9B,EAAwC;AACtCY,mBAAK,CAAC,YAAD,CAAL;AACA,mBAAKM,OAAL,CAAaC,IAAb,CAAkB;AAACC,oBAAI,EAAC;AAAN,eAAlB;AAAqC,aAFvC,MAGK,KAAKF,OAAL,CAAaC,IAAb,CAAkB;AAACC,kBAAI,EAAC;AAAN,aAAlB;AACN,WA1BD,EA0BGC,KA1BH,CA0BSC,KAAI,IAAK;AAChBV,iBAAK,CAAC,WAAD,CAAL;AAEAF,mBAAO,CAACa,GAAR,CAAYD,KAAZ;AACD,WA9BD;AA+BF,SAjCA,MAkCK;AACHZ,iBAAO,CAACC,GAAR,CAAY,cAAZ;AACA,iBAAO,KAAP;AACF;AACD,OAvCD;AAwCF;;AA3CO;AAbI,CAAf","names":["mapMutations","axios","name","props","msg","String","data","loginData","number","password","methods","submit","$refs","validate","valid","post","params","then","res","console","log","alert","userToken","headers","token","changeLogin","Authorization","$router","push","path","catch","error","dir"],"sourceRoot":"","sources":["D:\\fdu\\software_engineering\\Lab\\5-Lab2\\Vue\\src\\components\\Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"login\">\r\n    <el-form class='login-container' ref=\"loginForm\" :model=\"loginData\" autocomplete=\"on\" label-position=\"left\">\r\n      <h2 class='login-title'>登录</h2>\r\n      <el-form-item\r\n        prop=\"number\"\r\n        :rules=\"[{ required: true, message: '用户名不能为空'}]\"\r\n      >\r\n        <el-input\r\n          name=\"number\"\r\n          v-model=\"loginData.number\"\r\n          ref=\"number\"\r\n          placeholder=\"学号/工号\"\r\n          type=\"text\"\r\n          tabindex=\"1\"\r\n        />\r\n      </el-form-item> \r\n      <el-form-item\r\n        prop=\"password\"\r\n        :rules=\"[{ required: true, message: '密码不能为空'}]\"\r\n      >\r\n        <el-input\r\n          name=\"password\"\r\n          v-model=\"loginData.password\"\r\n          placeholder=\"密码\"\r\n          type=\"password\"\r\n          tabindex=\"2\"\r\n          @keydown.enter=\"submit\"\r\n        />\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button style=\"margin: 3px auto\" type=\"primary\" @click=\"submit\">登录</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations } from 'vuex';\r\nimport axios from 'axios'\r\nexport default {\r\n  name: 'UserLogin',\r\n  props: {\r\n    msg: String\r\n  },\r\n  data() {\r\n    return {\r\n      loginData: {\r\n        number:null,\r\n        password:''\r\n      },\r\n    }\r\n  },\r\n  methods: {\r\n     ...mapMutations(['changeLogin']),\r\n    submit() {\r\n      this.$refs['loginForm'].validate(valid => {\r\n        if(valid) {\r\n          // let data = {'username':this.loginData.username,'password':this.loginData.password};\r\n          axios.post('http://localhost:8081/login', null,{params:this.loginData})\r\n          // axios.post('http://localhost:8081/login', this.loginData)\r\n          // {\r\n          //   // headers: {'Content-Type': 'application/json; charset=utf-8'},\r\n          //   params: this.loginData\r\n          // //   // username:this.loginData.username,\r\n          // //   // password:this.loginData.password\r\n          // })\r\n          // axios({\r\n          //   methods: \"post\",\r\n          //   url: 'http://localhost:8081/login',\r\n          //   headers: {'Content-Type': 'application/json; charset=utf-8'},\r\n          //   params: this.loginData\r\n          // })\r\n          .then(res => {\r\n            console.log(res);\r\n            alert('登陆成功');\r\n            this.userToken = 'Bearer ' + res.headers.token;\r\n            // 将用户token保存到vuex中\r\n            this.changeLogin({ Authorization: this.userToken });//传参内容为一个对象\r\n            \r\n\r\n            if(this.loginData.password == '123456') {\r\n              alert('初次登录，请重置密码')\r\n              this.$router.push({path:\"/password\"})}\r\n            else this.$router.push({path:\"/student\"});\r\n          }).catch(error => {\r\n            alert('账号或密码错误!!');\r\n            \r\n            console.dir(error);\r\n          });\r\n        }\r\n        else {\r\n          console.log('error submit');\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\nh3 {\r\n  margin: 40px 0 0;\r\n}\r\n\r\n.login-container {\r\n  border-radius: 15px;\r\n  background-clip: padding-box;\r\n  margin: 90px auto;\r\n  width: 350px;\r\n  padding: 35px 35px 15px 35px;\r\n  background: #fff;\r\n  border: 1px solid #eaeaea;\r\n  box-shadow: 0 0 25px #cac6c6;\r\n}\r\n\r\n.login-title {\r\n  margin: 0px auto 40px auto;\r\n  text-align: center;\r\n  color: #505458;\r\n}\r\n\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}