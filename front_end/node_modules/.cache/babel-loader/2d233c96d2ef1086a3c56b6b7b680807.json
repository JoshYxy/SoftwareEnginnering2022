{"ast":null,"code":"/* eslint-disable */\nimport axios from 'axios';\nimport { Edit } from '@element-plus/icons-vue';\nexport default {\n  name: 'EditableFormitem',\n  props: [\"data\", \"rule\", \"label\", \"userData\"],\n  components: {\n    Edit\n  },\n\n  data() {\n    return {\n      buttonOn: false,\n      edit: false,\n      user: {\n        info: this.data //修改中的值\n\n      },\n      // info: this.data,\n      edited_info: this.data //显示出来的值\n\n    };\n  },\n\n  watch: {\n    data: {\n      handler() {\n        this.edited_info = this.data;\n        this.user.info = this.data;\n      }\n\n    }\n  },\n  methods: {\n    submit() {\n      //axios\n      this.$refs['user'].validate(valid => {\n        if (valid) {\n          //匹配后端格式\n          let postData = {\n            role: this.userData.role,\n            number: this.userData.number,\n            password: this.userData.password,\n            phone: this.label === '电话：' ? this.user.info : this.userData.phone,\n            email: this.label === '邮箱：' ? this.user.info : this.userData.email\n          };\n          axios.post('http://localhost:8081/user/info', userData).then(res => {\n            console.log(res);\n            this.$emit('changeInfo', {\n              label: this.label,\n              value: this.user.info\n            });\n            this.edited_info = this.user.info;\n            this.edit = false;\n          }).catch(error => {\n            alert(\"修改失败\");\n            console.dir(error);\n          });\n        }\n      });\n    },\n\n    cancel() {\n      this.edit = false;\n      this.user.info = this.edited_info;\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAiCA;AACA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAAQC,IAAR,QAAmB,yBAAnB;AACA,eAAe;AACXC,MAAI,EAAE,kBADK;AAEXC,OAAK,EAAE,CAAC,MAAD,EAAS,MAAT,EAAiB,OAAjB,EAA0B,UAA1B,CAFI;AAGXC,YAAU,EAAC;AACPH;AADO,GAHA;;AAMXI,MAAI,GAAG;AACH,WAAO;AACHC,cAAQ,EAAE,KADP;AAEHC,UAAI,EAAE,KAFH;AAGHC,UAAI,EAAC;AACDC,YAAI,EAAC,KAAKJ,IADT,CACa;;AADb,OAHF;AAMH;AACAK,iBAAW,EAAE,KAAKL,IAPf,CAOoB;;AAPpB,KAAP;AASH,GAhBU;;AAiBXM,OAAK,EAAE;AACHN,QAAI,EAAE;AACFO,aAAO,GAAE;AACL,aAAKF,WAAL,GAAiB,KAAKL,IAAtB;AACA,aAAKG,IAAL,CAAUC,IAAV,GAAe,KAAKJ,IAApB;AACH;;AAJC;AADH,GAjBI;AAyBXQ,SAAO,EAAE;AACLC,UAAM,GAAG;AACL;AACA,WAAKC,KAAL,CAAW,MAAX,EAAmBC,QAAnB,CAA4BC,KAAI,IAAK;AACjC,YAAGA,KAAH,EAAS;AACL;AACA,cAAIC,QAAO,GAAI;AACXC,gBAAI,EAAE,KAAKC,QAAL,CAAcD,IADT;AAEXE,kBAAM,EAAE,KAAKD,QAAL,CAAcC,MAFX;AAGXC,oBAAQ,EAAE,KAAKF,QAAL,CAAcE,QAHb;AAIXC,iBAAK,EAAE,KAAKC,KAAL,KAAa,KAAb,GAAmB,KAAKhB,IAAL,CAAUC,IAA7B,GAAkC,KAAKW,QAAL,CAAcG,KAJ5C;AAKXE,iBAAK,EAAE,KAAKD,KAAL,KAAa,KAAb,GAAmB,KAAKhB,IAAL,CAAUC,IAA7B,GAAkC,KAAKW,QAAL,CAAcK;AAL5C,WAAf;AAOAzB,eAAK,CAAC0B,IAAN,CAAW,iCAAX,EAA6CN,QAA7C,EACKO,IADL,CACUC,GAAE,IAAI;AACRC,mBAAO,CAACC,GAAR,CAAYF,GAAZ;AACA,iBAAKG,KAAL,CAAW,YAAX,EAAyB;AAACP,mBAAK,EAAE,KAAKA,KAAb;AAAoBQ,mBAAK,EAAE,KAAKxB,IAAL,CAAUC;AAArC,aAAzB;AACA,iBAAKC,WAAL,GAAiB,KAAKF,IAAL,CAAUC,IAA3B;AACA,iBAAKF,IAAL,GAAU,KAAV;AACH,WANL,EAOK0B,KAPL,CAOWC,KAAI,IAAK;AAChBC,iBAAK,CAAC,MAAD,CAAL;AACIN,mBAAO,CAACO,GAAR,CAAYF,KAAZ;AACH,WAVL;AAYJ;AACH,OAvBD;AAwBH,KA3BI;;AA4BLG,UAAM,GAAG;AACL,WAAK9B,IAAL,GAAU,KAAV;AACA,WAAKC,IAAL,CAAUC,IAAV,GAAe,KAAKC,WAApB;AACJ;;AA/BK;AAzBE,CAAf","names":["axios","Edit","name","props","components","data","buttonOn","edit","user","info","edited_info","watch","handler","methods","submit","$refs","validate","valid","postData","role","userData","number","password","phone","label","email","post","then","res","console","log","$emit","value","catch","error","alert","dir","cancel"],"sourceRoot":"","sources":["D:\\fdu\\software_engineering\\Lab\\5-Lab\\front_end\\src\\components\\EditableFormitem.vue"],"sourcesContent":["<template>\r\n    <el-form\r\n    label-width=\"120px\"\r\n    :rules=\"this.rule\"\r\n    :model=\"user\"\r\n    ref=\"user\"\r\n    >\r\n    <el-form-item \r\n        @mouseover=\"buttonOn=true\"\r\n        @mouseout=\"buttonOn=false\" \r\n        prop=\"info\" \r\n        >\r\n        <template #label>{{label}}</template>\r\n        <div class=\"editabel-form-container\"> \r\n            <!-- {{this.label}} -->\r\n            <span class=\"span-container\" v-show=\"!edit\">{{edited_info}}</span>\r\n            <el-input v-show=\"edit\" v-model=\"user.info\"  />\r\n        </div>\r\n        <el-button v-show=\"buttonOn&&(!edit)\" type=\"text\" style=\"float:right\" @click=\"edit=true\"  >\r\n            编辑<el-icon class=\"el-icon--right\"><Edit /></el-icon>\r\n        </el-button>\r\n        <el-button v-show=\"edit\" type=\"text\" style=\"float:right\" @click=\"submit\">\r\n            提交\r\n        </el-button>\r\n        <el-button v-show=\"edit\" type=\"text\" style=\"float:right\" @click=\"cancel\">\r\n            取消\r\n        </el-button>\r\n       \r\n    </el-form-item>\r\n    </el-form>\r\n</template>\r\n\r\n<script>\r\n/* eslint-disable */\r\nimport axios from 'axios'\r\nimport {Edit} from '@element-plus/icons-vue'\r\nexport default {\r\n    name: 'EditableFormitem',\r\n    props: [\"data\", \"rule\", \"label\", \"userData\"],\r\n    components:{\r\n        Edit,\r\n    },\r\n    data() {\r\n        return {\r\n            buttonOn: false,\r\n            edit: false,\r\n            user:{\r\n                info:this.data//修改中的值\r\n            },\r\n            // info: this.data,\r\n            edited_info: this.data,//显示出来的值\r\n        }\r\n    },\r\n    watch: {\r\n        data: {\r\n            handler(){\r\n                this.edited_info=this.data;\r\n                this.user.info=this.data;\r\n            },\r\n        }\r\n    },\r\n    methods: {\r\n        submit() {\r\n            //axios\r\n            this.$refs['user'].validate(valid => {\r\n                if(valid){\r\n                    //匹配后端格式\r\n                    let postData = {\r\n                        role: this.userData.role, \r\n                        number: this.userData.number,\r\n                        password: this.userData.password,\r\n                        phone: this.label==='电话：'?this.user.info:this.userData.phone,\r\n                        email: this.label==='邮箱：'?this.user.info:this.userData.email,\r\n                    }\r\n                    axios.post('http://localhost:8081/user/info',userData) \r\n                        .then(res =>{\r\n                            console.log(res)\r\n                            this.$emit('changeInfo', {label: this.label, value: this.user.info})\r\n                            this.edited_info=this.user.info\r\n                            this.edit=false\r\n                        })\r\n                        .catch(error => {\r\n                        alert(\"修改失败\")\r\n                            console.dir(error)\r\n                        })\r\n\r\n                }\r\n            })\r\n        },\r\n        cancel() {\r\n            this.edit=false\r\n            this.user.info=this.edited_info\r\n        }\r\n    }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n/* .form-item-label{\r\n    \r\n} */\r\n.editabel-form-container{\r\n  min-width:200px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}