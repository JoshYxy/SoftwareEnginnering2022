{"ast":null,"code":"import { ElMessage, ElMessageBox } from 'element-plus';\nimport axios from 'axios';\nexport default {\n  name: 'MajorMaintenance',\n\n  data() {\n    return {\n      id: 0,\n      visible: false,\n      defaultProps: {\n        children: 'majors',\n        label: 'name'\n      },\n      collegeData: [{\n        id: 1,\n        name: '计算机科学技术学院',\n        majors: [{\n          id: 1,\n          name: '大数据'\n        }, {\n          id: 2,\n          name: '信息安全'\n        }]\n      }, {\n        id: 2,\n        name: '生命科学学院',\n        majors: [{\n          id: 1,\n          name: '生物'\n        }, {\n          id: 2,\n          name: '123'\n        }]\n      }, {\n        id: 3,\n        name: '软件工程学院',\n        majors: [{\n          id: 1,\n          name: '软件工程'\n        }]\n      }]\n    };\n  },\n\n  methods: {\n    appendCollege() {\n      const data = {\n        id: this.id++,\n        name: '新的学院' + this.id,\n        majors: []\n      };\n      this.collegeData.push(data);\n      this.openAlter(data);\n    },\n\n    append(data) {\n      const newChild = {\n        id: this.id++,\n        name: '新的专业' + this.id\n      };\n\n      if (!data.majors) {\n        data.majors = [];\n      }\n\n      data.majors.push(newChild);\n      this.openAlter(newChild);\n      this.collegeData = [...this.collegeData]; //更新数据，刷新页面\n    },\n\n    alter(data, name) {\n      data.name = name; //TODO:axios\n\n      this.collegeData = [...this.collegeData];\n    },\n\n    remove(node, data) {\n      //TODO:axios\n      const parent = node.parent;\n      console.log(parent);\n      const children = parent.data.majors || parent.data;\n      const index = children.findIndex(d => d.id === data.id);\n      children.splice(index, 1);\n      this.collegeData = [...this.collegeData];\n    },\n\n    openRemove(node, data) {\n      ElMessageBox.confirm('是否删除 ' + data.name + (data.majors ? \"\" : \"专业\"), 'Warning', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.remove(node, data);\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        });\n      }).catch(() => {\n        ElMessage({\n          type: 'info',\n          message: '删除取消'\n        });\n      });\n    },\n\n    openAlter(data) {\n      const alertMessage = '请输入新的' + (data.majors ? '学院' : '专业') + '名称';\n      ElMessageBox.prompt(alertMessage, '修改', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消'\n      }).then(({\n        value\n      }) => {\n        this.alter(data, value);\n        ElMessage({\n          type: 'success',\n          message: `修改成功`\n        });\n      }).catch(() => {\n        ElMessage({\n          type: 'info',\n          message: '修改取消'\n        });\n      });\n    }\n\n  },\n\n  created() {\n    axios.get(\"http://localhost:8081/admin/edu\").then(res => {\n      this.collegeData = res;\n\n      for (let i in this.collegeData) {\n        //替换变量名,对应后端数据\n        this.collegeData[i] = JSON.parse(JSON.stringify(this.collegeData[i]).replace(/collegeVOId/g, \"id\"));\n        this.collegeData[i] = JSON.parse(JSON.stringify(this.collegeData[i]).replace(/majorId/g, \"id\"));\n        this.collegeData[i] = JSON.parse(JSON.stringify(this.collegeData[i]).replace(/collegeVOName/g, \"name\"));\n        this.collegeData[i] = JSON.parse(JSON.stringify(this.collegeData[i]).replace(/majorName/g, \"name\"));\n      }\n    }).catch(error => {\n      console.dir(error);\n    });\n  }\n\n};","map":{"version":3,"mappings":"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","names":["ElMessage","ElMessageBox","axios","name","data","id","visible","defaultProps","children","label","collegeData","majors","methods","appendCollege","push","openAlter","append","newChild","alter","remove","node","parent","console","log","index","findIndex","d","splice","openRemove","confirm","confirmButtonText","cancelButtonText","type","then","message","catch","alertMessage","prompt","value","created","get","res","i","JSON","parse","stringify","replace","error","dir"],"sourceRoot":"","sources":["C:\\Users\\32519\\5-Lab\\front_end\\src\\components\\MajorMaintenance.vue"],"sourcesContent":["<template>\r\n  <div class=\"majorMaintenance\" >\r\n    <h2 style=\"margin-right:250px\">专业信息管理</h2>\r\n    <el-button style=\"display:block;margin:0 615px auto auto\"  type='primary' @click=\"appendCollege()\"> 新增学院 </el-button>\r\n    <el-tree\r\n      :data=\"this.collegeData\"\r\n      default-expand-all\r\n      :props=\"this.defaultProps\" \r\n      :expand-on-click-node=\"false\"\r\n      class=\"el-tree-container\"\r\n    >\r\n      <template #default=\"{ node, data }\">\r\n        <span class=\"custom-tree-node\">\r\n          <span>{{ data.name }}</span>\r\n          <span>\r\n            <a v-if=\"data.majors\" @click=\"append(data)\" style=\"font-weight: bold\"> 新增专业 </a>\r\n     \r\n            <a @click=\"openAlter(data)\" style=\"font-weight: bold\"> 修改 </a>\r\n            <a @click=\"openRemove(node, data)\"> 删除 </a>\r\n          </span>\r\n        </span>\r\n      </template>\r\n    </el-tree>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nimport axios from 'axios'\r\nexport default {\r\n  name: 'MajorMaintenance',\r\n  data() {\r\n    return { \r\n      id: 0,\r\n      visible: false,\r\n      defaultProps: {\r\n        children: 'majors',\r\n        label: 'name',\r\n      },\r\n      collegeData: [\r\n        { \r\n          id: 1,\r\n          name: '计算机科学技术学院', \r\n          majors: [\r\n              {id: 1, name: '大数据'},\r\n              {id: 2, name: '信息安全'}\r\n          ]\r\n        },\r\n        { \r\n          id: 2,\r\n          name: '生命科学学院', \r\n          majors: [\r\n              {id: 1, name: '生物'},\r\n              {id: 2, name: '123'}\r\n          ]\r\n        },\r\n        { \r\n          id: 3,\r\n          name: '软件工程学院', \r\n          majors: [\r\n              {id: 1, name: '软件工程'},\r\n          ]\r\n        },\r\n      ],\r\n    }\r\n  },\r\n  methods: {\r\n    appendCollege() {\r\n      const data = {id: this.id++, name: '新的学院'+this.id, majors:[]}\r\n      this.collegeData.push(data)\r\n      \r\n      this.openAlter(data)\r\n    },\r\n    append(data) {\r\n      const newChild = { id: this.id++, name: '新的专业'+this.id}\r\n      if (!data.majors) {\r\n        data.majors = []\r\n      }\r\n      data.majors.push(newChild)\r\n      this.openAlter(newChild)\r\n      this.collegeData = [...this.collegeData]//更新数据，刷新页面\r\n    },\r\n    alter(data, name) {\r\n      data.name=name;\r\n      //TODO:axios\r\n      this.collegeData = [...this.collegeData]\r\n    },\r\n    remove(node, data) {\r\n      //TODO:axios\r\n      const parent = node.parent\r\n      console.log(parent)\r\n      const children = parent.data.majors || parent.data\r\n      const index = children.findIndex((d) => d.id === data.id)\r\n      children.splice(index, 1)\r\n      this.collegeData = [...this.collegeData]\r\n    },\r\n    openRemove(node, data) {\r\n      ElMessageBox.confirm(\r\n        '是否删除 ' + data.name + (data.majors?\"\":\"专业\"),\r\n        'Warning',\r\n        {\r\n          confirmButtonText: '确认',\r\n          cancelButtonText: '取消',\r\n          type: 'warning',\r\n        }\r\n      )\r\n        .then(() => {\r\n          this.remove(node, data)\r\n          ElMessage({\r\n            type: 'success',\r\n            message: '删除成功',\r\n          })\r\n        })\r\n        .catch(() => {\r\n          ElMessage({\r\n            type: 'info',\r\n            message: '删除取消',\r\n          })\r\n        })\r\n    },\r\n    openAlter(data) {\r\n      const alertMessage='请输入新的'+(data.majors?'学院':'专业')+'名称'\r\n      ElMessageBox.prompt(alertMessage, '修改', {\r\n        confirmButtonText: '确认',\r\n        cancelButtonText: '取消',\r\n      })\r\n        .then(({ value }) => {\r\n          this.alter(data, value)\r\n          ElMessage({  \r\n            type: 'success',\r\n            message: `修改成功`,\r\n          })\r\n        })\r\n        .catch(() => {\r\n          ElMessage({\r\n            type: 'info',\r\n            message: '修改取消',\r\n          })\r\n        })\r\n    }\r\n   \r\n  },\r\n  created() {\r\n    axios.get(\"http://localhost:8081/admin/edu\")\r\n      .then(res => {\r\n        this.collegeData = res\r\n        for(let i in this.collegeData) {//替换变量名,对应后端数据\r\n          this.collegeData[i] = JSON.parse(JSON.stringify(this.collegeData[i]).replace(/collegeVOId/g,\"id\"))\r\n          this.collegeData[i] = JSON.parse(JSON.stringify(this.collegeData[i]).replace(/majorId/g,\"id\"))\r\n          this.collegeData[i] = JSON.parse(JSON.stringify(this.collegeData[i]).replace(/collegeVOName/g,\"name\"))\r\n          this.collegeData[i] = JSON.parse(JSON.stringify(this.collegeData[i]).replace(/majorName/g,\"name\"))\r\n          \r\n        }\r\n      }).catch(error => {\r\n            \r\n        console.dir(error);\r\n      });\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style>\r\n.el-tree-container{\r\n  width:600px;\r\n  margin-left: 150px;\r\n\r\n}\r\n.el-tree-node__expand-icon{\r\n  width:300px;\r\n  max-height: 12px;\r\n  margin-right:-140px;\r\n  transform: none !important;\r\n}\r\n.el-tree-node__expand-icon .expanded{\r\n  width:300px;\r\n  max-height: 12px;\r\n  transform: rotate(90deg);\r\n  margin-right:-150px;\r\n  position: relative;\r\n  transform: none !important;\r\n}\r\n.custom-tree-node {\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  font-size: 14px;\r\n  padding-right: 8px;  \r\n  font-size: 16px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}