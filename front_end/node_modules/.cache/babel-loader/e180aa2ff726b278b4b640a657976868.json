{"ast":null,"code":"// import axios from 'axios'\nimport { validName, validPhone, validPassport, validEmail } from './jsComponents/CheckRules'; //格式检查\n\nexport default {\n  name: 'MajorMaintenance',\n  props: ['userInfo', 'collegeData', 'namea'],\n\n  data() {\n    return {\n      dialogFormVisible: false,\n      formLabelWidth: '140px',\n      //与录入信息处相同\n      // this.userInfo,\n      user: {\n        number1: null,\n        role1: '',\n        name1: '',\n        id1: '',\n        phone1: '',\n        email1: '',\n        stu_id: null,\n        teach_id: null,\n        password1: '',\n        major_1: '',\n        college1: {}\n      },\n      rules: {\n        college1: [{\n          required: true,\n          message: '请选择学院',\n          trigger: 'change'\n        }],\n        major_1: [{\n          required: true,\n          message: '请选择专业',\n          trigger: 'change'\n        }],\n        role1: [{\n          required: true,\n          message: '请选择身份',\n          trigger: 'change'\n        }],\n        stu_id1: [{\n          required: true,\n          message: '学号不能为空',\n          trigger: 'blur'\n        }, {\n          pattern: /^\\d{6,6}$/,\n          message: '学号为6位数字',\n          trigger: 'blur'\n        }, {\n          pattern: /^[0-1][0-9][0-9]*$|^2[0-2][0-9]*$/,\n          message: '学号必须为注册年份后两位开头的数字(小于22)'\n        }],\n        teach_id1: [{\n          required: true,\n          message: '工号不能为空',\n          trigger: 'blur'\n        }, {\n          pattern: /^\\d{8,8}$/,\n          message: '工号为8位数字',\n          trigger: 'blur'\n        }, {\n          pattern: /^[0-1][0-9][0-9]*$|^2[0-2][0-9]*$/,\n          message: '工号必须为注册年份后两位开头的数字(小于22)'\n        }],\n        name1: [{\n          required: true,\n          message: '姓名不能为空',\n          trigger: 'blur'\n        }, {\n          validator: validName,\n          trigger: ['blur', 'change']\n        }],\n        id1: [{\n          required: true,\n          message: '身份证不能为空',\n          trigger: 'blur'\n        }, {\n          validator: validPassport,\n          trigger: 'blur'\n        }],\n        phone1: [{\n          required: false,\n          trigger: ['blur', 'change']\n        }, {\n          validator: validPhone,\n          trigger: 'blur'\n        }],\n        email1: [{\n          required: false,\n          trigger: 'blur'\n        }, {\n          validator: validEmail,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n\n  watch: {\n    \"user.college\": {\n      handler() {\n        this.user.major_1 = '';\n      },\n\n      deep: true\n    }\n  },\n  methods: {\n    startChange() {\n      this.dialogFormVisible = true; //从数据库获取user信息\n    },\n\n    submit() {\n      this.$refs['user'].validate(valid => {\n        if (valid) {\n          this.dialogFormVisible = false;\n          this.$emit('changeInfo', this.user); //   console.log(this.user)\n          //   // axios.post('http://localhost:8081/register', null, {params:this.user})\n          //   axios.post('http://localhost:8081/user/new', this.user)\n          //   .then(function(resp){\n          //     console.log(resp)\n          //     alert('提交成功')\n          //   }).catch(error => {\n          //     if(error.response.status == 421){\n          //       if(this.user.role == 'student')\n          //         alert('学号已存在')\n          //       else\n          //         alert('工号已存在')\n          //       this.user.stu_id = ''\n          //       this.user.teach_id = ''\n          //     }\n          //     if(error.response.status == 420){\n          //       alert('身份证已存在');\n          //       this.user.id = ''\n          //     }\n          //     console.dir(error);\n          //   })\n        } else {\n          console.log('error ssssubmit');\n          return false;\n        }\n      });\n    }\n\n  },\n  created: function () {// this.user=JSON.parse(JSON.stringify(this.userInfo))\n    //   this.user.number=this.number\n    //   this.user.id=this.id\n    //   this.user.name=this.name\n    //   this.user.phone=this.phone\n    //   this.user.email=this.email\n    //   this.user.password=this.password\n    //   this.user.college=this.college\n    //   this.user.major_=this.major_\n    //   this.user.role=this.role\n  }\n};","map":{"version":3,"mappings":"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","names":["validName","validPhone","validPassport","validEmail","name","props","data","dialogFormVisible","formLabelWidth","user","number1","role1","name1","id1","phone1","email1","stu_id","teach_id","password1","major_1","college1","rules","required","message","trigger","stu_id1","pattern","teach_id1","validator","watch","handler","deep","methods","startChange","submit","$refs","validate","valid","$emit","console","log","created"],"sourceRoot":"","sources":["D:\\fdu\\software_engineering\\Lab\\5-Lab\\front_end\\src\\components\\UserinfoMaintenance.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-button type=\"text\" @click=\"startChange\"\r\n        >编辑</el-button\r\n    >\r\n\r\n    <el-dialog v-model=\"dialogFormVisible\" title=\"信息修改\" :append-to-body=\"true\" >\r\n      \r\n        <el-form id=\"admin_modify\" ref=\"user\" :model=\"user\" :rules=\"rules\" autocomplete=\"on\"  text-align: center>\r\n          \r\n            <el-form-item prop=\"college1\">\r\n                <el-select v-model=\"user.college1\" value-key=\"name\" placeholder=\"学院\">\r\n                <el-option :key=\"colleges.id\" :value=\"colleges\" :label=\"colleges.name\" v-for=\"colleges in collegeData\" ></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n\r\n            <el-form-item prop=\"major_1\" >\r\n                <el-select v-model=\"user.major_1\" placeholder=\"专业\">\r\n                <el-option :key=\"major.id\" :value=\"major.name\" :label=\"major.name\" v-for=\"major in user.college1.major\" ></el-option>\r\n                </el-select>\r\n            </el-form-item>\r\n            \r\n            <el-form-item prop=\"name1\">\r\n                <el-input\r\n                type=\"text\"\r\n                name=\"name\"\r\n                v-model=\"user.name1\"\r\n                placeholder=\"姓名\"\r\n                />\r\n            </el-form-item> \r\n\r\n            <el-form-item prop=\"id1\">\r\n                <el-input\r\n                name=\"id\"\r\n                v-model=\"user.id1\"\r\n                placeholder=\"身份证号\"\r\n                type=\"text\"\r\n                />\r\n            </el-form-item>\r\n\r\n            <el-form-item prop=\"phone1\">\r\n                <el-input\r\n                type=\"text\"\r\n                name=\"phone\"\r\n                v-model=\"user.phone1\"\r\n                placeholder=\"手机号\"\r\n                />\r\n            </el-form-item> \r\n\r\n            <el-form-item prop=\"email1\">\r\n                <el-input\r\n                type=\"text\"\r\n                name=\"email\"\r\n                v-model=\"user.email1\"\r\n                placeholder=\"邮箱\"\r\n                />\r\n            </el-form-item>\r\n        </el-form>\r\n        <template #footer>\r\n        <span class=\"dialog-footer\">\r\n            <el-button @click=\"dialogFormVisible = false\">Cancel</el-button>\r\n            <el-button type=\"primary\" @click=\"submit\">Confirm</el-button>\r\n        </span>\r\n        </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\n// import axios from 'axios'\r\n\r\nimport {validName,validPhone,validPassport,validEmail} from './jsComponents/CheckRules'//格式检查\r\nexport default {\r\n  name: 'MajorMaintenance',\r\n  props: ['userInfo','collegeData','namea'],\r\n  data() {\r\n    return {\r\n\r\n        dialogFormVisible: false,\r\n        formLabelWidth: '140px',\r\n//与录入信息处相同\r\n        // this.userInfo,\r\n        user: {\r\n          number1: null,\r\n          role1: '',\r\n          name1: '',\r\n          id1: '',\r\n          phone1: '',\r\n          email1: '',\r\n          stu_id: null,\r\n          teach_id: null,\r\n          password1: '',\r\n          major_1: '',\r\n          college1: {},\r\n        },\r\n\r\n        rules: {\r\n            college1: [{required: true, message: '请选择学院', trigger: 'change'}],\r\n            major_1: [{required: true, message: '请选择专业', trigger: 'change'}],\r\n            role1: [{required: true, message: '请选择身份', trigger: 'change'}],\r\n            stu_id1: [{required: true, message: '学号不能为空', trigger: 'blur'},\r\n                    {pattern: /^\\d{6,6}$/, message: '学号为6位数字', trigger: 'blur'},\r\n                    {pattern: /^[0-1][0-9][0-9]*$|^2[0-2][0-9]*$/, message: '学号必须为注册年份后两位开头的数字(小于22)'}],\r\n            teach_id1: [{required: true, message: '工号不能为空', trigger: 'blur'},\r\n                    {pattern: /^\\d{8,8}$/, message: '工号为8位数字', trigger: 'blur'},\r\n                    {pattern: /^[0-1][0-9][0-9]*$|^2[0-2][0-9]*$/, message: '工号必须为注册年份后两位开头的数字(小于22)'}],\r\n            name1: [{required: true, message: '姓名不能为空', trigger: 'blur'},\r\n                {validator: validName, trigger: ['blur', 'change']}],\r\n            id1: [{ required: true, message: '身份证不能为空', trigger: 'blur'},\r\n                    { validator: validPassport, trigger: 'blur' }],\r\n            phone1: [{required: false, trigger: ['blur', 'change']},\r\n                    {validator: validPhone, trigger: 'blur'}],\r\n            email1: [{required: false, trigger: 'blur'},\r\n                    {validator: validEmail, trigger: 'blur'}],\r\n        },\r\n    }\r\n  },\r\n  watch:{\r\n    \"user.college\": {\r\n      handler(){\r\n        this.user.major_1='';  \r\n      },\r\n      deep: true  \r\n    }\r\n  },\r\n  methods: {\r\n      startChange(){\r\n        this.dialogFormVisible = true\r\n        //从数据库获取user信息\r\n      },\r\n      submit(){\r\n      this.$refs['user'].validate(valid => {\r\n        if(valid){\r\n            this.dialogFormVisible = false\r\n            this.$emit('changeInfo', this.user);\r\n        //   console.log(this.user)\r\n        //   // axios.post('http://localhost:8081/register', null, {params:this.user})\r\n        //   axios.post('http://localhost:8081/user/new', this.user)\r\n        //   .then(function(resp){\r\n        //     console.log(resp)\r\n        //     alert('提交成功')\r\n              \r\n        //   }).catch(error => {\r\n        //     if(error.response.status == 421){\r\n        //       if(this.user.role == 'student')\r\n        //         alert('学号已存在')\r\n        //       else\r\n        //         alert('工号已存在')\r\n        //       this.user.stu_id = ''\r\n        //       this.user.teach_id = ''\r\n        //     }\r\n        //     if(error.response.status == 420){\r\n        //       alert('身份证已存在');\r\n        //       this.user.id = ''\r\n        //     }\r\n        //     console.dir(error);\r\n        //   })\r\n        }\r\n        else{\r\n          console.log('error ssssubmit');\r\n          return false\r\n        }\r\n      })\r\n        \r\n    }\r\n  },\r\n  created: function(){\r\n    // this.user=JSON.parse(JSON.stringify(this.userInfo))\r\n    //   this.user.number=this.number\r\n    //   this.user.id=this.id\r\n    //   this.user.name=this.name\r\n    //   this.user.phone=this.phone\r\n    //   this.user.email=this.email\r\n    //   this.user.password=this.password\r\n    //   this.user.college=this.college\r\n    //   this.user.major_=this.major_\r\n    //   this.user.role=this.role\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}