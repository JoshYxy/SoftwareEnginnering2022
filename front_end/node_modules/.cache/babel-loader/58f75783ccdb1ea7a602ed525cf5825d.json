{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport axios from 'axios';\nimport EditableFormitem from './EditableFormitem.vue';\nimport { Edit } from '@element-plus/icons-vue';\nexport default {\n  components: {\n    EditableFormitem,\n    Edit\n  },\n  name: 'PrivateinfoMaintnce',\n\n  data() {\n    var validPassword = (rule, value, callback) => {\n      const reg = /^(?![0-9]+$)(?![a-zA-Z]+$)(?![-_()]+$)[0-9A-Za-z-_()]{6,32}$/;\n\n      if (value !== '') {\n        if (reg.test(value)) {\n          if (this.userPassword.checkPassword !== '') {\n            this.$refs['userPassword'].validateField('checkPassword', () => null);\n          }\n\n          callback();\n        } else {\n          return callback(new Error('字母，数字或者特殊字符(-_)至少包含两种'));\n        }\n      }\n    };\n\n    var validPassword2 = (rule, value, callback) => {\n      if (value === this.userPassword.password) {\n        callback();\n      } else {\n        return callback(new Error('两次密码不一致'));\n      }\n    };\n\n    return {\n      phoneRules: {\n        info: [{\n          pattern: /^1[3|4|5|7|8][0-9]\\d{8}$/,\n          message: '手机号码必须为1开头的符合规则的11位数字'\n        }]\n      },\n      emailRules: {\n        info: [{\n          pattern: /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$/,\n          message: '邮箱地址不符合规则'\n        }]\n      },\n      buttonOn: false,\n      phoneEdit: false,\n      // checkPassword: '',\n      dialogFormVisible: false,\n      userPassword: {\n        password: '',\n        checkPassword: ''\n      },\n      userData: {\n        number: 1,\n        role: '',\n        name: '',\n        id: '',\n        phone: '',\n        //phone的真值存在editable_formitem里，此处的不能传给后端\n        email: '',\n        //email的真值存在editable_formitem里，此处的不能传给后端\n        stu_id: null,\n        teach_id: null,\n        password: '',\n        major: '',\n        college: ''\n      },\n      userData_back: {\n        number: 220001,\n        role: 'student',\n        name: '张晓王',\n        id: '310111200201553211',\n        phone: '13301182222',\n        //phone的真值存在editable_formitem里，此处的不能传给后端\n        email: '123@qq.com',\n        //email的真值存在editable_formitem里，此处的不能传给后端\n        stu_id: null,\n        teach_id: null,\n        password: '123456',\n        major: '软件工程班',\n        college: '计算机科学技术学院'\n      },\n      rules: {\n        password: [{\n          required: true,\n          message: '请输入新密码',\n          trigger: 'blur'\n        }, {\n          min: 6,\n          max: 32,\n          message: '长度为6-32个字符',\n          trigger: ['blur', 'change']\n        }, {\n          validator: validPassword,\n          trigger: ['blur', 'change']\n        }],\n        checkPassword: [{\n          required: true,\n          message: '请输入确认密码',\n          trigger: 'blur'\n        }, {\n          validator: validPassword2,\n          trigger: ['blur', 'change']\n        }]\n      }\n    };\n  },\n\n  methods: {\n    updateUser(e) {\n      if (e.label == '邮箱：') this.userData.email = e.value;\n      if (e.label == '电话：') this.userData.phone = e.value;\n    },\n\n    editPassword() {\n      this.userPassword.password = '';\n      this.userPassword.checkPassword = '';\n      this.dialogFormVisible = true;\n    },\n\n    submitPassword() {\n      this.$refs['userPassword'].validate(valid => {\n        if (valid) {\n          this.dialogFormVisible = false;\n          this.userData.password = this.userPassword.password;\n          axios.post('http://localhost:8081/user/info', this.userData).catch(error => {\n            alert(\"修改失败\");\n            console.dir(error);\n          });\n        }\n      });\n    }\n\n  },\n\n  created() {\n    axios.get('http://localhost:8081/user/info').then(res => {\n      this.userData = res.data.data1;\n      console.log(this.userData);\n    }).catch(error => {\n      alert(\"与服务器连接失败\");\n      console.dir(error);\n    });\n  }\n\n};","map":{"version":3,"mappings":"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","names":["axios","EditableFormitem","Edit","components","name","data","validPassword","rule","value","callback","reg","test","userPassword","checkPassword","$refs","validateField","Error","validPassword2","password","phoneRules","info","pattern","message","emailRules","buttonOn","phoneEdit","dialogFormVisible","userData","number","role","id","phone","email","stu_id","teach_id","major","college","userData_back","rules","required","trigger","min","max","validator","methods","updateUser","e","label","editPassword","submitPassword","validate","valid","post","catch","error","alert","console","dir","created","get","then","res","data1","log"],"sourceRoot":"","sources":["D:\\desktop\\5-Lab\\front_end\\src\\components\\PrivateinfoMaintnce.vue"],"sourcesContent":["<template>\r\n  <div class=\"descriptions-container\">\r\n    <el-form\r\n    label-width=\"120px\"\r\n    \r\n    :model=\"userData\"\r\n    >\r\n    <el-form-item label=\"姓名：\" class=\"form-label\" >\r\n      <span class=\"info-container\">{{userData.name}}</span>\r\n    </el-form-item>\r\n    <el-form-item label=\"学号：\" class=\"form-label\" >\r\n      <span class=\"info-container\">{{userData.number}}</span>\r\n    </el-form-item>\r\n    <el-form-item label=\"身份证：\" class=\"form-label\" >\r\n      <span class=\"info-container\">{{userData.id}}</span>\r\n    </el-form-item>\r\n    <el-form-item label=\"学院：\" class=\"form-label\" >\r\n      <span class=\"info-container\">{{userData.college}}</span>\r\n    </el-form-item>\r\n    <el-form-item label=\"专业：\" class=\"form-label\" >\r\n      <span class=\"info-container\">{{userData.major}}</span>\r\n    </el-form-item>\r\n\r\n    <editable-formitem @changeInfo=\"updateUser($event)\" label=\"电话：\" :data=\"userData.phone\" :rule=\"phoneRules\" :userData=\"userData\"></editable-formitem>\r\n    <editable-formitem @changeInfo=\"updateUser($event)\" label=\"邮箱：\" :data=\"userData.email\" :rule=\"emailRules\" :userData=\"userData\"></editable-formitem>\r\n    <el-form-item label=\"密码：\" class=\"form-label\" @mouseover=\"buttonOn=true\"\r\n        @mouseout=\"buttonOn=false\" >\r\n      <span class=\"info-container\">{{userData.password}}</span>\r\n\r\n      <el-button v-show=\"buttonOn\" type=\"text\" style=\"float:right\" @click=\"editPassword()\" >\r\n        编辑<el-icon class=\"el-icon--right\"><Edit /></el-icon>\r\n      </el-button>\r\n    </el-form-item>\r\n \r\n  </el-form>\r\n  <el-dialog v-model=\"dialogFormVisible\" title=\"修改密码\" :append-to-body=\"true\" >\r\n      \r\n        <el-form \r\n          ref=\"userPassword\" \r\n          :model=\"userPassword\" \r\n          :rules=\"rules\" \r\n          autocomplete=\"on\"  \r\n          text-align:center \r\n          hide-required-asterisk\r\n          >\r\n            <el-form-item prop=\"password\" label=\"新密码\">\r\n                <el-input type=\"password\" name=\"password\" v-model=\"userPassword.password\"/>\r\n            </el-form-item>\r\n            <el-form-item prop=\"checkPassword\" label=\"确认密码\">\r\n                <el-input type=\"password\" name=\"password\" v-model=\"userPassword.checkPassword\"/>\r\n            </el-form-item>\r\n        </el-form>\r\n        <template #footer>\r\n        <span class=\"dialog-footer\">\r\n            <el-button @click=\"dialogFormVisible=false\">取消</el-button>\r\n            <el-button type=\"primary\" @click=\"submitPassword\">确认</el-button>\r\n        </span>\r\n        </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport EditableFormitem from './EditableFormitem.vue'\r\nimport {Edit} from '@element-plus/icons-vue'\r\nexport default {\r\n  components:{\r\n    EditableFormitem,\r\n    Edit\r\n  },\r\n  name: 'PrivateinfoMaintnce',\r\n  data() {\r\n    var validPassword = (rule, value, callback) => {\r\n      const reg = /^(?![0-9]+$)(?![a-zA-Z]+$)(?![-_()]+$)[0-9A-Za-z-_()]{6,32}$/\r\n      if(value!==''){\r\n          if (reg.test(value)) {\r\n            if(this.userPassword.checkPassword!==''){\r\n              this.$refs['userPassword'].validateField('checkPassword', () => null)\r\n            } \r\n            callback()\r\n          } else {\r\n          return callback(new Error('字母，数字或者特殊字符(-_)至少包含两种'))\r\n          }\r\n      }\r\n    }\r\n    var validPassword2 = (rule, value, callback) => {\r\n        if (value === this.userPassword.password) {\r\n            callback()\r\n        } else {\r\n            return callback(new Error('两次密码不一致'))\r\n        }\r\n    };\r\n    return {\r\n      phoneRules:{info:[{pattern: /^1[3|4|5|7|8][0-9]\\d{8}$/, message: '手机号码必须为1开头的符合规则的11位数字'}]},\r\n      emailRules:{info:[{pattern: /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((.[a-zA-Z0-9_-]{2,3}){1,2})$/, message: '邮箱地址不符合规则'}]},\r\n      buttonOn: false,\r\n      phoneEdit: false,\r\n      // checkPassword: '',\r\n      dialogFormVisible: false,\r\n      userPassword: {\r\n        password: '',\r\n        checkPassword: '',\r\n      },\r\n      userData: {\r\n        number: 1,\r\n        role: '',\r\n        name: '',\r\n        id: '',\r\n        phone: '',//phone的真值存在editable_formitem里，此处的不能传给后端\r\n        email: '',//email的真值存在editable_formitem里，此处的不能传给后端\r\n        stu_id: null,\r\n        teach_id: null,\r\n        password: '',\r\n        major: '',\r\n        college: ''\r\n      },\r\n      userData_back: {\r\n        number: 220001,\r\n        role: 'student',\r\n        name: '张晓王',\r\n        id: '310111200201553211',\r\n        phone: '13301182222',//phone的真值存在editable_formitem里，此处的不能传给后端\r\n        email: '123@qq.com',//email的真值存在editable_formitem里，此处的不能传给后端\r\n        stu_id: null,\r\n        teach_id: null,\r\n        password: '123456',\r\n        major: '软件工程班',\r\n        college: '计算机科学技术学院'\r\n      },\r\n      rules: {\r\n        password:  [{required: true, message: '请输入新密码', trigger: 'blur'},\r\n                    {min: 6, max: 32, message: '长度为6-32个字符', trigger: ['blur', 'change']},\r\n                    {validator: validPassword, trigger: ['blur', 'change']}],\r\n        checkPassword: [{required: true, message: '请输入确认密码', trigger: 'blur'},\r\n                    {validator: validPassword2, trigger: ['blur', 'change']}]\r\n      },\r\n    }\r\n  },\r\n  methods: {\r\n    updateUser(e) {\r\n      if(e.label == '邮箱：')this.userData.email = e.value\r\n      if(e.label == '电话：')this.userData.phone = e.value\r\n    },\r\n    editPassword() {\r\n      this.userPassword.password=''\r\n      this.userPassword.checkPassword=''\r\n      this.dialogFormVisible=true\r\n    },\r\n    submitPassword() {\r\n      this.$refs['userPassword'].validate(valid => {\r\n        if(valid){\r\n          this.dialogFormVisible=false\r\n                            \r\n          this.userData.password=this.userPassword.password  \r\n          axios.post('http://localhost:8081/user/info',this.userData)\r\n          .catch(error => {\r\n            alert(\"修改失败\")\r\n              console.dir(error)\r\n            })\r\n        }\r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    axios.get('http://localhost:8081/user/info')\r\n          .then(res => {\r\n            this.userData = res.data.data1\r\n            console.log(this.userData)\r\n  \r\n          }).catch(error => {\r\n            alert(\"与服务器连接失败\")\r\n            console.dir(error);\r\n          });\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.data-container{\r\n  min-width:200px;\r\n}\r\n/* .span-container{\r\n  width:100px;\r\n} */\r\n.descriptions-container{\r\n  width:600px;\r\n  margin:auto;\r\n  /* font-size:18px !important; */\r\n}\r\n.info-container{\r\n  min-width: 200px;\r\n}\r\n\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}