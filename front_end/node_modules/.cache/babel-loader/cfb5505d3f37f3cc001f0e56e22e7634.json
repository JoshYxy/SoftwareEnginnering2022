{"ast":null,"code":"import { createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, withKeys as _withKeys, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-26084dc2\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"login\"\n};\n\nconst _hoisted_2 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h2\", {\n  class: \"login-title\"\n}, \"登录\", -1\n/* HOISTED */\n));\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_avatar = _resolveComponent(\"avatar\");\n\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n\n  const _component_el_input = _resolveComponent(\"el-input\");\n\n  const _component_el_form_item = _resolveComponent(\"el-form-item\");\n\n  const _component_key = _resolveComponent(\"key\");\n\n  const _component_circle_check = _resolveComponent(\"circle-check\");\n\n  const _component_el_button = _resolveComponent(\"el-button\");\n\n  const _component_el_form = _resolveComponent(\"el-form\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_el_form, {\n    class: \"login-container\",\n    ref: \"loginForm\",\n    model: $data.loginData,\n    autocomplete: \"on\",\n    \"label-position\": \"left\"\n  }, {\n    default: _withCtx(() => [_hoisted_2, _createVNode(_component_el_form_item, {\n      prop: \"number\",\n      rules: [{\n        required: true,\n        message: '用户名不能为空'\n      }]\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        \"prefix-icon\": \"Avatar\",\n        name: \"number\",\n        modelValue: $data.loginData.number,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.loginData.number = $event),\n        ref: \"number\",\n        placeholder: \"学号/工号\",\n        type: \"text\",\n        maxlength: \"40\"\n      }, {\n        prefix: _withCtx(() => [_createVNode(_component_el_icon, {\n          class: \"el-icon_a\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_avatar)]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"modelValue\"])]),\n      _: 1\n      /* STABLE */\n\n    }), _createVNode(_component_el_form_item, {\n      prop: \"password\",\n      rules: [{\n        required: true,\n        message: '密码不能为空'\n      }]\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_input, {\n        \"prefix-icon\": \"Key\",\n        name: \"password\",\n        modelValue: $data.loginData.password,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.loginData.password = $event),\n        placeholder: \"密码\",\n        type: \"password\",\n        maxlength: \"40\",\n        onKeydown: _withKeys($options.submit, [\"enter\"])\n      }, {\n        prefix: _withCtx(() => [_createVNode(_component_el_icon, {\n          class: \"el-icon_k\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_key)]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"modelValue\", \"onKeydown\"])]),\n      _: 1\n      /* STABLE */\n\n    }), _createVNode(_component_el_form_item, null, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        style: {\n          \"display\": \"block\",\n          \"margin\": \"0 auto\"\n        },\n        type: \"primary\",\n        onClick: $options.submit\n      }, {\n        default: _withCtx(() => [_createVNode(_component_el_icon, {\n          size: 20\n        }, {\n          default: _withCtx(() => [_createVNode(_component_circle_check)]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"onClick\"])]),\n      _: 1\n      /* STABLE */\n\n    })]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"model\"])]);\n}","map":{"version":3,"mappings":";;;;;AACOA,OAAK,EAAC;;;gEAEPC,oBAA+B,IAA/B,EAA+B;AAA3BD,OAAK,EAAC;AAAqB,CAA/B,EAAwB,IAAxB,EAA0B;AAAA;AAA1B;;;;;;;;;;;;;;;;;;;uBAFJE,oBA+CM,KA/CN,cA+CM,CA9CJC,aA4CUC,kBA5CV,EA4CU;AA5CDJ,SAAK,EAAC,iBA4CL;AA5CuBK,OAAG,EAAC,WA4C3B;AA5CwCC,SAAK,EAAEC,eA4C/C;AA5C0DC,gBAAY,EAAC,IA4CvE;AA5C4E,sBAAe;AA4C3F,GA5CV;sBACE,MAA+B,CAA/BC,UAA+B,EAC/BN,aAgBeO,uBAhBf,EAgBe;AAfbC,UAAI,EAAC,QAeQ;AAdZC,WAAK,EAAE;AAAAC;AAAAC;AAAA;AAcK,KAhBf;wBAIE,MAWW,CAXXX,aAWWY,mBAXX,EAWW;AAVT,uBAAY,QAUH;AATTC,YAAI,EAAC,QASI;oBARAT,gBAAUU,MAQV;mEARAV,gBAAUU,SAAMC,OAQhB;AAPTb,WAAG,EAAC,QAOK;AANTc,mBAAW,EAAC,OAMH;AALTC,YAAI,EAAC,MAKI;AAJTC,iBAAS,EAAC;AAID,OAXX;AAQaC,cAAM,WACf,MAA+C,CAA/CnB,aAA+CoB,kBAA/C,EAA+C;AAAtCvB,eAAK,EAAC;AAAgC,SAA/C,EAA0B;4BAAC,MAAU,CAAVG,aAAUqB,iBAAV,CAAU,EAAX;;;;AAAA,SAA1B,CAA+C,CADhC;;;;OARnB;;AAAA,uBAWW;;;;KAfb,CAD+B,EAkB/BrB,aAiBeO,uBAjBf,EAiBe;AAhBbC,UAAI,EAAC,UAgBQ;AAfZC,WAAK,EAAE;AAAAC;AAAAC;AAAA;AAeK,KAjBf;wBAIE,MAYW,CAZXX,aAYWY,mBAZX,EAYW;AAXT,uBAAY,KAWH;AAVTC,YAAI,EAAC,UAUI;oBATAT,gBAAUkB,QASV;mEATAlB,gBAAUkB,WAAQP,OASlB;AARTC,mBAAW,EAAC,IAQH;AAPTC,YAAI,EAAC,UAOI;AANTC,iBAAS,EAAC,IAMD;AALRK,iBAAO,YAAQC,eAAR,EAAc,SAAd;AAKC,OAZX;AASaL,cAAM,WACf,MAA4C,CAA5CnB,aAA4CoB,kBAA5C,EAA4C;AAAnCvB,eAAK,EAAC;AAA6B,SAA5C,EAA0B;4BAAC,MAAO,CAAPG,aAAOyB,cAAP,CAAO,EAAR;;;;AAAA,SAA1B,CAA4C,CAD7B;;;;OATnB;;AAAA,oCAYW;;;;KAhBb,CAlB+B,EAoC/BzB,aAMeO,uBANf,EAMe,IANf,EAMe;wBALb,MAIY,CAJZP,aAIY0B,oBAJZ,EAIY;AAJAC,aAAmC,EAAnC;AAAA;AAAA;AAAA,SAIA;AAJoCV,YAAI,EAAC,SAIzC;AAJoDW,eAAK,EAAEJ;AAI3D,OAJZ;0BACE,MAEU,CAFVxB,aAEUoB,kBAFV,EAEU;AAFAS,cAAI,EAAE;AAEN,SAFV,EAAkB;4BAChB,MAAgB,CAAhB7B,aAAgB8B,uBAAhB,CAAgB,EADA;;;;AAAA,SAAlB,CAEU;;;;OAHZ;;AAAA,oBAIY,EACC;;;;AAAA,KANf,CApC+B;;;;GADjC;;AAAA,cA8CI,CA/CN","names":["class","_createElementVNode","_createElementBlock","_createVNode","_component_el_form","ref","model","$data","autocomplete","_hoisted_2","_component_el_form_item","prop","rules","required","message","_component_el_input","name","number","$event","placeholder","type","maxlength","prefix","_component_el_icon","_component_avatar","password","onKeydown","$options","_component_key","_component_el_button","style","onClick","size","_component_circle_check"],"sourceRoot":"","sources":["D:\\fdu\\software_engineering\\Lab\\5-Lab\\front_end\\src\\views\\Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"login\">\r\n    <el-form class='login-container' ref=\"loginForm\" :model=\"loginData\" autocomplete=\"on\" label-position=\"left\">\r\n      <h2 class='login-title'>登录</h2>\r\n      <el-form-item\r\n        prop=\"number\"\r\n        :rules=\"[{ required: true, message: '用户名不能为空'}]\"\r\n      >\r\n        <el-input \r\n          prefix-icon=\"Avatar\" \r\n          name=\"number\" \r\n          v-model=\"loginData.number\" \r\n          ref=\"number\" \r\n          placeholder=\"学号/工号\" \r\n          type=\"text\" \r\n          maxlength=\"40\">\r\n          <template #prefix>\r\n            <el-icon class=\"el-icon_a\"><avatar /></el-icon>\r\n          </template>\r\n        </el-input>\r\n      </el-form-item> \r\n      <el-form-item\r\n        prop=\"password\"\r\n        :rules=\"[{ required: true, message: '密码不能为空'}]\"\r\n      >\r\n        <el-input\r\n          prefix-icon=\"Key\" \r\n          name=\"password\"\r\n          v-model=\"loginData.password\"\r\n          placeholder=\"密码\"\r\n          type=\"password\"\r\n          maxlength=\"40\"\r\n          @keydown.enter=\"submit\"\r\n          >\r\n          <template #prefix>\r\n            <el-icon class=\"el-icon_k\"><key /></el-icon>\r\n          </template>\r\n        </el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button  style=\"display:block;margin:0 auto\" type=\"primary\" @click=\"submit\">\r\n          <el-icon :size=\"20\">\r\n            <circle-check />\r\n          </el-icon>\r\n        </el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations } from 'vuex';\r\nimport {CircleCheck,Avatar,Key} from \"@element-plus/icons\";\r\nimport axios from 'axios'\r\nexport default {\r\n  name: 'UserLogin',\r\n    components:{\r\n    Avatar,\r\n    CircleCheck,\r\n    Key\r\n  },\r\n  data() {\r\n    return {\r\n      userToken: '',\r\n      loginData: {\r\n        number:null,\r\n        password:''\r\n      },\r\n    }\r\n  },\r\n  // this.axios({\r\n  //           method: 'post',\r\n  //           url: '/user/login',\r\n  //           data: _this.loginForm\r\n  //         })\r\n  methods: {\r\n     ...mapMutations(['changeLogin']),\r\n    submit() {\r\n      this.$refs['loginForm'].validate(valid => {\r\n        if(valid) {\r\n          // axios.post('http://localhost:8081/login', null,{params:this.loginData})\r\n          axios.post('http://localhost:8081/user', this.loginData)\r\n          .then(res => {\r\n            console.log(res);\r\n            alert('登陆成功');\r\n            this.userToken = res.headers.token;\r\n            // 将用户token保存到vuex中\r\n            this.changeLogin({ Authorization: this.userToken });//传参内容为一个对象\r\n            localStorage.setItem('role', res.headers.role)\r\n\r\n            if(this.loginData.password == '123456') {\r\n              alert('初次登录，请重置密码')\r\n              this.$router.push({path:\"/password\"})}\r\n            else this.$router.push({path:\"/home/welcome\"});\r\n          }).catch(error => {\r\n            if(error.response.status == 426){\r\n                alert('身份已过期');\r\n              }\r\n            else alert('账号或密码错误!!');\r\n            console.dir(error);\r\n          });\r\n        }\r\n        else {\r\n          console.log('error submit');\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\nh3 {\r\n  margin: 40px 0 0;\r\n}\r\n\r\n.login-container {\r\n  border-radius: 15px;\r\n  background-clip: padding-box;\r\n  margin: 120px 150px auto auto;\r\n  width: 350px;\r\n  padding: 35px 35px 15px 35px;\r\n  background-color: transparent;\r\n  border: 1px solid #eaeaea;\r\n  box-shadow: 0 0 25px #cac6c6;\r\n}\r\n\r\n.login-title {\r\n  margin: 0 auto 40px auto;\r\n  text-align: center;\r\n  color: #505458;\r\n}\r\n\r\n.el-icon_a {\r\n  margin-top: 10px;\r\n}\r\n\r\n.el-icon_k {\r\n  margin-top: 10px;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}