{"ast":null,"code":"import { setCourseTime } from '../jsComponents/CourseSet';\nimport { ElMessage } from 'element-plus';\nimport axios from 'axios';\nimport global_ from '../jsComponents/global';\nimport { Search } from '@element-plus/icons-vue';\nexport default {\n  components: {\n    Search\n  },\n\n  data() {\n    return {\n      CLOSE: global_.CLOSE,\n      ONE_OFF: global_.ONE_OFF,\n      ONE_ON: global_.ONE_ON,\n      TWO_OFF: global_.TWO_OFF,\n      TWO_ON: global_.TWO_ON,\n      dialogAvlVis: [false, false, false, false, false, false, false, false],\n      majorAvlVis: [false, false, false, false, false, false, false, false, false, false, false, false],\n      dialogSelVis: [false, false, false, false, false, false, false, false],\n      majorSelVis: [false, false, false, false, false, false, false, false, false, false, false, false],\n      dialogStuVis: [false, false, false, false, false, false, false, false],\n      majorStuVis: [false, false, false, false, false, false, false, false, false, false, false, false],\n      semesters: global_.semesters,\n      years: global_.years,\n      periods: global_.periods,\n      activeName: 'available',\n      searchContent: '',\n      courseStatus: '1',\n      times: [],\n      classroom: [],\n      courses: [{\n        courseId: 1,\n        courseName: '软件工程',\n        courseNum: 'SOFT220011',\n        classHours: '4',\n        credits: '4',\n        courseTime: '',\n        collegeId: '',\n        collegeName: '计算机与技术学院',\n        times: [[], [1, 2, 3, 5, 6, 8, 10, 11, 12], [3], [], [], [], []],\n        building: 'H3',\n        roomNum: '301',\n        courseInfo: '123',\n        selected: '80',\n        capacity: '100',\n        type: 'normal'\n      }, {\n        courseId: 2,\n        courseName: '离散数学',\n        courseNum: 'SOFT220022',\n        classHours: '3',\n        credits: '5',\n        courseTime: '',\n        collegeId: '',\n        collegeName: '计算机与技术学院',\n        times: [[], [], [], [3, 8], []],\n        building: 'HGX',\n        roomNum: '502',\n        courseInfo: '123',\n        selected: '100',\n        capacity: '100',\n        type: 'normal'\n      }],\n      selectedCourses: [{\n        courseId: 1,\n        courseName: '软件',\n        courseNum: 'SOFT220011',\n        classHours: '4',\n        credits: '4',\n        courseTime: '',\n        collegeId: '',\n        collegeName: '计算机与技术学院',\n        times: [[], [1, 2, 3, 5, 6, 8, 10, 11, 12], [3], [], [], [], []],\n        building: 'H3',\n        roomNum: '301',\n        courseInfo: '123',\n        selected: '80',\n        capacity: '100',\n        type: 'normal'\n      }, {\n        courseId: 2,\n        courseName: '数学',\n        courseNum: 'SOFT220022',\n        classHours: '3',\n        credits: '5',\n        courseTime: '',\n        collegeId: '',\n        collegeName: '计算机与技术学院',\n        times: [[], [], [], [3, 8], []],\n        building: 'HGX',\n        roomNum: '502',\n        courseInfo: '123',\n        selected: '100',\n        capacity: '100',\n        type: 'normal'\n      }],\n      studiedCourses: [{\n        courseId: 1,\n        courseName: '软件',\n        courseNum: 'SOFT220011',\n        classHours: '4',\n        credits: '4',\n        courseTime: '',\n        collegeId: '',\n        collegeName: '计算机与技术学院',\n        times: [[], [1, 2, 3, 5, 6, 8, 10, 11, 12], [3], [], [], [], []],\n        building: 'H3',\n        roomNum: '301',\n        courseInfo: '123',\n        isGeneral: '专业课程',\n        majors: [[\"计算机科学技术学院\", \"大数据\"], [\"计算机科学技术学院\", \"信息安全\"], ['软件工程学院', '软件工程']],\n        year: '2021-2022',\n        semester: '春'\n      }, {\n        courseId: 2,\n        courseName: '数学',\n        courseNum: 'SOFT220022',\n        classHours: '3',\n        credits: '5',\n        courseTime: '',\n        collegeId: '',\n        collegeName: '计算机与技术学院',\n        times: [[], [], [], [3, 8], []],\n        building: 'HGX',\n        roomNum: '502',\n        courseInfo: '321',\n        isGeneral: '通选课程',\n        majors: [],\n        year: '2020-2021',\n        semester: '秋'\n      }]\n    };\n  },\n\n  computed: {\n    yearFilters() {\n      let obj = [];\n\n      for (let i = 0; i < this.years.length; i++) {\n        obj.push({\n          text: this.years[i] + this.semesters[0],\n          value: this.years[i] + this.semesters[0]\n        });\n        obj.push({\n          text: this.years[i] + this.semesters[1],\n          value: this.years[i] + this.semesters[1]\n        });\n      }\n\n      return obj;\n    },\n\n    roomFilters() {\n      let obj = []; //找到对应的数据 并添加到obj\n\n      for (let i = 0; i < this.classroom.length; i++) {\n        for (let j = 0; j < this.classroom[i].room.length; j++) {\n          obj.push({\n            text: this.classroom[i].aka + this.classroom[i].room[j].name,\n            value: this.classroom[i].aka + this.classroom[i].room[j].name\n          });\n        }\n      } // this.courses.filter(item => {\n      //     obj.push({\n      //         text:item['building']+item['roomNum'],\n      //         value:item['building']+item['roomNum'],\n      //     })\n      // })\n      // //因为column有重复数据，所以要进行去重\n      // console.log(obj)\n\n\n      return obj;\n    },\n\n    timeFilters() {\n      let obj = [];\n\n      for (let i = 0; i < this.periods.length; i++) {\n        for (let j = 0; j < this.times.length; j++) {\n          obj.push({\n            text: this.periods[i] + '第' + (parseInt(j) + 1) + '节课',\n            value: this.periods[i] + '第' + (parseInt(j) + 1) + '节课'\n          });\n        }\n      }\n\n      return obj;\n    }\n\n  },\n  methods: {\n    submitSearch() {\n      console.log(this.searchContent);\n      axios.post(\"http://localhost:8081/student/course/verified/search\", {\n        search: this.searchContent\n      }).then(res => {\n        console.log(res.data.msg);\n        this.courses = res.data.data1;\n\n        for (let course of this.courses) {\n          course.courseTime = '';\n          setCourseTime(course, course.times);\n        }\n      }).catch(err => {\n        alert(err.response.data.msg);\n        this.courses = [];\n      });\n    },\n\n    resetSearch() {\n      axios.get('http://localhost:8081/student/course/verified').then(res => {\n        this.courses = res.data.data1;\n\n        for (let course of this.courses) {\n          course.courseTime = '';\n          setCourseTime(course, course.times);\n        }\n      }).catch(err => {\n        alert(err.response.data.msg);\n        this.courses = [];\n      });\n    },\n\n    handleClick(tab, event) {\n      console.log(tab, event);\n\n      if (tab.props.name == 'available') {\n        axios.get('http://localhost:8081/student/course/verified').then(res => {\n          this.courses = res.data.data1;\n\n          for (let course of this.courses) {\n            // this.dialogTableVisible.push(false)\n            course.courseTime = '';\n            setCourseTime(course, course.times);\n          }\n        }).catch(err => {\n          alert(err.response.data.msg);\n          this.courses = [];\n        });\n        console.log(1);\n      }\n\n      if (tab.props.name == 'selected') {\n        //axios获取已选课程\n        axios.get('http://localhost:8081/student/course/selected').then(res => {\n          this.selectedCourses = res.data.data1;\n\n          for (let course of this.selectedCourses) {\n            // this.dialogTableVisible.push(false)\n            course.courseTime = '';\n            setCourseTime(course, course.times);\n          }\n        }).catch(err => {\n          alert(err.response.data.msg);\n          this.selectedCourses = [];\n        });\n        console.log(2);\n      }\n\n      if (tab.props.name == 'studied') {\n        axios.get('http://localhost:8081/student/course/studied').then(res => {\n          this.studiedCourses = res.data.data1;\n\n          for (let course of this.studiedCourses) {\n            // this.dialogTableVisible.push(false)\n            course.courseTime = '';\n            setCourseTime(course, course.times);\n          }\n        }).catch(err => {\n          alert(err.response.data.msg);\n          this.studiedCourses = [];\n        });\n        console.log(3);\n      }\n    },\n\n    selectCourse(index) {\n      // this.selectedCourses.push(this.courses[index])\n      axios.post(\"http://localhost:8081/student/selection\", {\n        courseId: this.courses[index].courseId\n      }).then(res => {\n        console.log(res);\n        this.courses.splice(index, 1);\n        ElMessage({\n          type: 'success',\n          message: '选课成功！'\n        });\n      }).catch(err => {\n        alert(err.response.data.msg);\n      });\n    },\n\n    quitCourse(index) {\n      // this.courses.push(this.selectedCourses[index])\n      // this.selectedCourses.splice(index,1) \n      axios.delete(\"http://localhost:8081/student/selection\", {\n        data: {\n          courseId: this.selectedCourses[index].courseId\n        }\n      }).then(res => {\n        ElMessage({\n          type: 'success',\n          message: '退课成功'\n        });\n        this.selectedCourses.splice(index, 1);\n        console.log(res);\n      });\n    },\n\n    filterYear(value, row) {\n      return row['year'] + row['semester'] === value;\n    },\n\n    filterRoom(value, row) {\n      return row['building'] + row['roomNum'] === value;\n    },\n\n    filterTime(value, row) {\n      for (let j = 0; j < row.times.length; j++) {\n        for (let k = 0; k < row.times[j].length; k++) {\n          // let num = parseInt(data.times[j][k])+j*this.times.length\n          // console.log(num)\n          if (this.periods[j] + '第' + row.times[j][k] + '节课' == value) return true;\n        }\n      }\n\n      return false;\n    },\n\n    clearFilter() {\n      this.$refs['courses'].clearFilter();\n    }\n\n  },\n\n  async created() {\n    await axios.get('http://localhost:8081/user/curriculaVariable').then(res => {\n      this.courseStatus = res.data.data1;\n      console.log(res);\n    }).catch(error => {\n      console.dir(error);\n    });\n\n    if (this.courseStatus == '二轮选课开始' || this.courseStatus == '一轮选课开始') {\n      await axios.get('http://localhost:8081/student/course/verified').then(res => {\n        this.courses = res.data.data1;\n\n        for (let i = 0; i < this.courses.length; i++) {\n          this.courses[i].index = i;\n          this.courses[i].courseTime = '';\n          setCourseTime(this.courses[i], this.courses[i].times);\n        }\n      }).catch(err => {\n        alert(err.response.data.msg);\n        this.courses = [];\n      });\n      await axios.get('http://localhost:8081/user/course/new').then(res => {\n        this.classroom = res.data.data2;\n\n        for (let i = 0; i < this.classroom.length; i++) {\n          this.classroom[i] = JSON.parse(JSON.stringify(this.classroom[i]).replace(/fullName/g, \"name\"));\n          this.classroom[i] = JSON.parse(JSON.stringify(this.classroom[i]).replace(/roomNum/g, \"name\"));\n          this.classroom[i] = JSON.parse(JSON.stringify(this.classroom[i]).replace(/abbrName/g, \"aka\"));\n        }\n\n        this.times = res.data.data3; // this.collegeData = res.data.data4\n        // for(let i = 0; i < this.collegeData.length; i++) {\n        //     if(this.collegeData[i].majors == []) {\n        //         this.collegeData[i]['disabled'] = true\n        //     }\n        // }\n      });\n    }\n  }\n\n};","map":{"version":3,"mappings":"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","names":["setCourseTime","ElMessage","axios","global_","Search","components","data","CLOSE","ONE_OFF","ONE_ON","TWO_OFF","TWO_ON","dialogAvlVis","majorAvlVis","dialogSelVis","majorSelVis","dialogStuVis","majorStuVis","semesters","years","periods","activeName","searchContent","courseStatus","times","classroom","courses","courseId","courseName","courseNum","classHours","credits","courseTime","collegeId","collegeName","building","roomNum","courseInfo","selected","capacity","type","selectedCourses","studiedCourses","isGeneral","majors","year","semester","computed","yearFilters","obj","i","length","push","text","value","roomFilters","j","room","aka","name","timeFilters","parseInt","methods","submitSearch","console","log","post","search","then","res","msg","data1","course","catch","err","alert","response","resetSearch","get","handleClick","tab","event","props","selectCourse","index","splice","message","quitCourse","delete","filterYear","row","filterRoom","filterTime","k","clearFilter","$refs","created","error","dir","data2","JSON","parse","stringify","replace","data3"],"sourceRoot":"","sources":["D:\\fdu\\software_engineering\\Lab\\5-Lab\\front_end\\src\\components\\course\\StudentCourse.vue"],"sourcesContent":["<template>\r\n    <div v-if=\"courseStatus == CLOSE\"> <h2>选课时间未到</h2></div>\r\n    <div v-if=\"courseStatus == ONE_OFF\"> <h2>第一轮选课已结束，请等待第二轮选课开始</h2></div>\r\n    <div v-if=\"courseStatus == TWO_OFF\"> <h2>第二轮选课已结束</h2></div>\r\n    <div v-if=\"courseStatus == ONE_ON || courseStatus == TWO_ON\">\r\n        <el-tabs v-model=\"activeName\" type=\"border-card\" @tab-click=\"handleClick\">\r\n            <el-tab-pane label=\"可选课程\" name=\"available\">\r\n                <h2>可选课程</h2>\r\n                <el-input class=\"search\" size=\"large\" placeholder=\"搜索课程\" v-model=\"searchContent\" @keyup.enter=\"submitSearch\">\r\n                    <template #suffix>\r\n                        <el-icon @click=\"submitSearch\" class=\"el-input__icon\"><search /></el-icon>\r\n                    </template>\r\n                </el-input>\r\n                <el-button @click=\"resetSearch\" type=\"primary\" style=\"margin-left: 210px\">查看全部可选课程</el-button>\r\n                <el-button @click=\"clearFilter\" type=\"danger\">重置筛选</el-button>\r\n                <!-- <el-button @click=\"test\">test </el-button> -->\r\n                <el-table class=\"class-table\" ref=\"courses\" :data=\"courses\" max-height=\"400px\">\r\n                    <el-table-column fixed prop=\"courseName\" label=\"课程名\" width=\"150\" />\r\n                    <el-table-column fixed prop=\"courseNum\" label=\"课程编号\" width=\"140\" />\r\n                    <el-table-column prop=\"collegeName\" label=\"开课院系\" width=\"180\" />\r\n                    <el-table-column prop=\"teacherName\" label=\"课程教师姓名\" width=\"120\" />\r\n                    <el-table-column prop=\"isGeneral\" label=\"课程类型\" width=\"220\">\r\n                        <template #default=\"scope\">\r\n                            <div v-if=\"scope.row.isGeneral == '通选课程'\">通选课程</div>\r\n                            <div v-else>\r\n                                <span style=\"padding-right:10px\">{{scope.row.isGeneral}}</span>\r\n                                <el-button type=\"text\" @click=\"majorAvlVis[scope.$index] = true\">查看专业</el-button>\r\n                                <el-dialog v-model=\"majorAvlVis[scope.$index]\" title=\"课程可选专业\" :append-to-body=\"true\">\r\n                                    <div v-for=\"major in scope.row.majors\" :key=\"major\">\r\n                                        {{major[1]}} ({{major[0]}})\r\n                                    </div>\r\n                                </el-dialog>\r\n                            </div>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column prop=\"classHours\" label=\"学时\" width=\"60\" />\r\n                    <el-table-column prop=\"credits\" label=\"学分\" width=\"60\" />\r\n                    <el-table-column prop=\"building,roomNum\" label=\"上课地点\" width=\"100\" \r\n                        column-key=\"room\"\r\n                        :filter-multiple=\"true\"\r\n                        :filters=\"roomFilters\"\r\n                        :filter-method=\"filterRoom\">\r\n                        <template #default=\"scope\">\r\n                            {{scope.row.building}}{{scope.row.roomNum}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column prop=\"courseTime\" label=\"上课时间\" width=\"180\"\r\n                                            :filter-multiple=\"true\"\r\n                        :filters=\"timeFilters\"\r\n                        :filter-method=\"filterTime\"\r\n                        />\r\n                    <el-table-column prop=\"courseInfo\" label=\"介绍\" width=\"150\" >\r\n                        <template #default=\"scope\">\r\n                            <el-button type=\"text\" @click=\"dialogAvlVis[scope.$index] = true\">查看详情</el-button>\r\n                            <el-dialog v-model=\"dialogAvlVis[scope.$index]\" title=\"课程介绍\" :append-to-body=\"true\">\r\n                            {{scope.row.courseInfo}}\r\n                            </el-dialog>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column fixed=\"right\" prop=\"capacity,selected\" label=\"选课人数\" width=\"150\">\r\n                        <template #default=\"scope\">\r\n                            {{scope.row.selected}}/{{scope.row.capacity}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column fixed=\"right\" label=\"操作\" width=\"180\">\r\n                        <template #default=\"scope\">\r\n                            <el-button @click=\"selectCourse(scope.row.index)\" type=\"primary\" round>选课</el-button>\r\n                        </template>\r\n                    </el-table-column>\r\n                </el-table>  \r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"已选课程\" name=\"selected\">\r\n                <h2>已选课程</h2>\r\n                <el-table class=\"class-table\" :data=\"selectedCourses\"  max-height=\"500px\">\r\n                    <el-table-column fixed prop=\"courseName\" label=\"课程名\" width=\"150\" />\r\n                    <el-table-column fixed prop=\"courseNum\" label=\"课程编号\" width=\"140\" />\r\n                    <el-table-column prop=\"collegeName\" label=\"开课院系\" width=\"180\" />\r\n                    <el-table-column prop=\"teacherName\" label=\"课程教师姓名\" width=\"120\" />\r\n                    <el-table-column prop=\"isGeneral\" label=\"课程类型\" width=\"220\">\r\n                        <template #default=\"scope\">\r\n                            <div v-if=\"scope.row.isGeneral == '通选课程'\">通选课程</div>\r\n                            <div v-else>\r\n                                <span style=\"padding-right:10px\">{{scope.row.isGeneral}}</span>\r\n                                <el-button type=\"text\" @click=\"majorSelVis[scope.$index] = true\">查看专业</el-button>\r\n                                <el-dialog v-model=\"majorSelVis[scope.$index]\" title=\"课程可选专业\" :append-to-body=\"true\">\r\n                                    <div v-for=\"major in scope.row.majors\" :key=\"major\">\r\n                                        {{major[1]}} ({{major[0]}})\r\n                                    </div>\r\n                                </el-dialog>\r\n                            </div>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column prop=\"classHours\" label=\"学时\" width=\"60\" />\r\n                    <el-table-column prop=\"credits\" label=\"学分\" width=\"60\" />\r\n                    <el-table-column prop=\"building,roomNum\" label=\"上课地点\" width=\"80\">\r\n                        <template #default=\"scope\">\r\n                            {{scope.row.building}}{{scope.row.roomNum}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column prop=\"courseTime\" label=\"上课时间\" width=\"180\" />\r\n                    <el-table-column prop=\"courseInfo\" label=\"介绍\" width=\"150\" >\r\n                        <template #default=\"scope\">\r\n                            <el-button type=\"text\" @click=\"dialogSelVis[scope.$index] = true\">查看详情</el-button>\r\n                            <el-dialog v-model=\"dialogSelVis[scope.$index]\" title=\"课程介绍\" :append-to-body=\"true\">\r\n                            {{scope.row.courseInfo}}\r\n                            </el-dialog>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column fixed=\"right\" prop=\"capacity,selected\" label=\"选课人数\" width=\"150\">\r\n                        <template #default=\"scope\">\r\n                            {{scope.row.selected}}/{{scope.row.capacity}}\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column fixed=\"right\" label=\"操作\" width=\"180\">\r\n                        <template #default=\"scope\">\r\n                            <el-button @click=\"quitCourse(scope.$index)\" type=\"danger\">退课</el-button>\r\n                        </template>\r\n                    </el-table-column>\r\n                </el-table> \r\n            </el-tab-pane>\r\n            <el-tab-pane label=\"已修课程\" name=\"studied\">\r\n                    <h2>已修课程</h2>\r\n                    <el-table class=\"class-table\" :data=\"studiedCourses\" max-height=\"500px\">\r\n                        <el-table-column fixed prop=\"courseName\" label=\"课程名\" width=\"150\" />\r\n                        <el-table-column fixed prop=\"courseNum\" label=\"课程编号\" width=\"140\" />\r\n                        <el-table-column prop=\"year,semester\" label=\"修读学期\" width=\"180\"\r\n                            :filter-multiple=\"true\"\r\n                            :filters=\"yearFilters\"\r\n                            :filter-method=\"filterYear\">\r\n                            <template #default=\"scope\">\r\n                                {{scope.row.year}}{{scope.row.semester}}\r\n                            </template>\r\n                        </el-table-column>\r\n                        <el-table-column prop=\"collegeName\" label=\"开课院系\" width=\"180\" />\r\n                        <el-table-column prop=\"teacherName\" label=\"课程教师姓名\" width=\"120\" />\r\n                        <el-table-column prop=\"isGeneral\" label=\"课程类型\" width=\"220\">\r\n                            <template #default=\"scope\">\r\n                                <div v-if=\"scope.row.isGeneral == '通选课程'\">通选课程</div>\r\n                                <div v-else>\r\n                                    <span style=\"padding-right:10px\">{{scope.row.isGeneral}}</span>\r\n                                    <el-button type=\"text\" @click=\"majorStuVis[scope.$index] = true\">查看专业</el-button>\r\n                                    <el-dialog v-model=\"majorStuVis[scope.$index]\" title=\"课程可选专业\" :append-to-body=\"true\">\r\n                                        <div v-for=\"major in scope.row.majors\" :key=\"major\">\r\n                                            {{major[1]}} ({{major[0]}})\r\n                                        </div>\r\n                                    </el-dialog>\r\n                                </div>\r\n                            </template>\r\n                        </el-table-column>\r\n                        <el-table-column prop=\"classHours\" label=\"学时\" width=\"60\" />\r\n                        <el-table-column prop=\"credits\" label=\"学分\" width=\"60\" />\r\n                        <el-table-column prop=\"building,roomNum\" label=\"上课地点\" width=\"100\">\r\n                            <template #default=\"scope\">\r\n                                {{scope.row.building}}{{scope.row.roomNum}}\r\n                            </template>\r\n                        </el-table-column>\r\n                        <el-table-column prop=\"courseTime\" label=\"上课时间\" width=\"180\" />\r\n                        <el-table-column prop=\"courseInfo\" label=\"介绍\" width=\"150\" >\r\n                            <template #default=\"scope\">\r\n                                <el-button type=\"text\" @click=\"dialogStuVis[scope.$index] = true\">查看详情</el-button>\r\n                                <el-dialog v-model=\"dialogStuVis[scope.$index]\" title=\"课程介绍\" :append-to-body=\"true\">\r\n                                {{scope.row.courseInfo}}\r\n                                </el-dialog>\r\n                            </template>\r\n                        </el-table-column>\r\n                    </el-table>  \r\n            </el-tab-pane>\r\n        </el-tabs>\r\n        \r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport {setCourseTime} from '../jsComponents/CourseSet'\r\nimport { ElMessage} from 'element-plus'\r\nimport axios from 'axios'\r\nimport global_ from '../jsComponents/global'\r\nimport { Search } from '@element-plus/icons-vue'\r\nexport default {\r\n    components: {\r\n        Search\r\n    },\r\n    data() {\r\n        return {\r\n            CLOSE: global_.CLOSE,\r\n            ONE_OFF: global_.ONE_OFF,\r\n            ONE_ON: global_.ONE_ON,\r\n            TWO_OFF: global_.TWO_OFF,\r\n            TWO_ON: global_.TWO_ON,\r\n            dialogAvlVis:[false,false,false,false,false,false,false,false,],\r\n            majorAvlVis:[false,false,false,false,false,false,false,false,false,false,false,false,],\r\n            dialogSelVis:[false,false,false,false,false,false,false,false,],\r\n            majorSelVis:[false,false,false,false,false,false,false,false,false,false,false,false,],\r\n            dialogStuVis:[false,false,false,false,false,false,false,false,],\r\n            majorStuVis:[false,false,false,false,false,false,false,false,false,false,false,false,],\r\n            semesters: global_.semesters,\r\n            years: global_.years,\r\n            periods: global_.periods,\r\n            activeName: 'available',\r\n            searchContent: '',\r\n            courseStatus: '1',\r\n            times: [],\r\n            classroom: [],\r\n            courses: [\r\n                {\r\n                    courseId: 1,\r\n                    courseName: '软件工程',\r\n                    courseNum: 'SOFT220011',\r\n                    classHours: '4',\r\n                    credits: '4',\r\n                    courseTime:'',\r\n                    collegeId: '',\r\n                    collegeName: '计算机与技术学院',\r\n                    times: [\r\n                        [],\r\n                        [1,2,3,5,6,8,10,11,12],\r\n                        [3],\r\n                        [],\r\n                        [],\r\n                        [],\r\n                        []\r\n                    ],\r\n                    building: 'H3',\r\n                    roomNum: '301',\r\n                    courseInfo: '123',\r\n                    selected: '80',\r\n                    capacity: '100',\r\n                    type: 'normal',\r\n                },\r\n                {\r\n                    courseId: 2,\r\n                    courseName: '离散数学',\r\n                    courseNum: 'SOFT220022',\r\n                    classHours: '3',\r\n                    credits: '5',\r\n                    courseTime:'',\r\n                    collegeId: '',\r\n                    collegeName: '计算机与技术学院',\r\n                    times: [\r\n                        [],\r\n                        [],\r\n                        [],\r\n                        [3,8],\r\n                        []\r\n                    ],\r\n                    building: 'HGX',\r\n                    roomNum: '502',\r\n                    courseInfo: '123',\r\n                    selected: '100',\r\n                    capacity: '100',\r\n                    type: 'normal',\r\n                }\r\n            ],\r\n            selectedCourses: [\r\n                {\r\n                    courseId: 1,\r\n                    courseName: '软件',\r\n                    courseNum: 'SOFT220011',\r\n                    classHours: '4',\r\n                    credits: '4',\r\n                    courseTime:'',\r\n                    collegeId: '',\r\n                    collegeName: '计算机与技术学院',\r\n                    times: [\r\n                        [],\r\n                        [1,2,3,5,6,8,10,11,12],\r\n                        [3],\r\n                        [],\r\n                        [],\r\n                        [],\r\n                        []\r\n                    ],\r\n                    building: 'H3',\r\n                    roomNum: '301',\r\n                    courseInfo: '123',\r\n                    selected: '80',\r\n                    capacity: '100',\r\n                    type: 'normal',\r\n                },\r\n                {\r\n                    courseId: 2,\r\n                    courseName: '数学',\r\n                    courseNum: 'SOFT220022',\r\n                    classHours: '3',\r\n                    credits: '5',\r\n                    courseTime:'',\r\n                    collegeId: '',\r\n                    collegeName: '计算机与技术学院',\r\n                    times: [\r\n                        [],\r\n                        [],\r\n                        [],\r\n                        [3,8],\r\n                        []\r\n                    ],\r\n                    building: 'HGX',\r\n                    roomNum: '502',\r\n                    courseInfo: '123',\r\n                    selected: '100',\r\n                    capacity: '100',\r\n                    type: 'normal',\r\n                }\r\n            ],\r\n            studiedCourses: [\r\n                {\r\n                    courseId: 1,\r\n                    courseName: '软件',\r\n                    courseNum: 'SOFT220011',\r\n                    classHours: '4',\r\n                    credits: '4',\r\n                    courseTime:'',\r\n                    collegeId: '',\r\n                    collegeName: '计算机与技术学院',\r\n                    times: [\r\n                        [],\r\n                        [1,2,3,5,6,8,10,11,12],\r\n                        [3],\r\n                        [],\r\n                        [],\r\n                        [],\r\n                        []\r\n                    ],\r\n                    building: 'H3',\r\n                    roomNum: '301',\r\n                    courseInfo: '123',\r\n                    isGeneral: '专业课程',\r\n                    majors: [\r\n                                [\"计算机科学技术学院\",\"大数据\"],\r\n                                [\"计算机科学技术学院\",\"信息安全\"],\r\n                                ['软件工程学院','软件工程']\r\n                            ],\r\n                    year:'2021-2022',\r\n                    semester:'春'\r\n                },\r\n                {\r\n                    courseId: 2,\r\n                    courseName: '数学',\r\n                    courseNum: 'SOFT220022',\r\n                    classHours: '3',\r\n                    credits: '5',\r\n                    courseTime:'',\r\n                    collegeId: '',\r\n                    collegeName: '计算机与技术学院',\r\n                    times: [\r\n                        [],\r\n                        [],\r\n                        [],\r\n                        [3,8],\r\n                        []\r\n                    ],\r\n                    building: 'HGX',\r\n                    roomNum: '502',\r\n                    courseInfo: '321',\r\n                    isGeneral: '通选课程',\r\n                    majors: [],\r\n                    year:'2020-2021',\r\n                    semester:'秋'\r\n                }\r\n            ],\r\n        }\r\n    },\r\n    computed: {\r\n        yearFilters() {\r\n            let obj = []\r\n            for(let i = 0; i < this.years.length; i++) {\r\n                obj.push({\r\n                    text:this.years[i]+this.semesters[0],\r\n                    value:this.years[i]+this.semesters[0],\r\n                })\r\n                obj.push({\r\n                    text:this.years[i]+this.semesters[1],\r\n                    value:this.years[i]+this.semesters[1],\r\n                })\r\n            }\r\n            return obj\r\n        }, \r\n        roomFilters(){\r\n            let obj = [];\r\n            //找到对应的数据 并添加到obj\r\n            for(let i = 0; i < this.classroom.length; i++) {\r\n                for(let j = 0; j < this.classroom[i].room.length; j++) {\r\n                    obj.push( {\r\n                        text: this.classroom[i].aka+this.classroom[i].room[j].name,\r\n                        value: this.classroom[i].aka+this.classroom[i].room[j].name,\r\n                    })\r\n                }\r\n            }\r\n            // this.courses.filter(item => {\r\n            //     obj.push({\r\n            //         text:item['building']+item['roomNum'],\r\n            //         value:item['building']+item['roomNum'],\r\n            //     })\r\n            // })\r\n            // //因为column有重复数据，所以要进行去重\r\n            // console.log(obj)\r\n            return obj\r\n        },\r\n        timeFilters() {\r\n            let obj = []\r\n            for(let i = 0; i < this.periods.length; i++) {\r\n                for(let j = 0; j < this.times.length; j++) {        \r\n                    obj.push({\r\n                        text:this.periods[i]+'第'+(parseInt(j)+1)+'节课',\r\n                        value:this.periods[i]+'第'+(parseInt(j)+1)+'节课',\r\n                    })\r\n                }\r\n            }\r\n            return obj\r\n        },\r\n    },\r\n    methods: {\r\n         submitSearch() {\r\n            console.log(this.searchContent)\r\n            axios.post(\"http://localhost:8081/student/course/verified/search\",{search: this.searchContent})\r\n            .then(res => {\r\n                console.log(res.data.msg)\r\n                this.courses = res.data.data1\r\n                for(let course of this.courses) {\r\n                    course.courseTime = ''\r\n                    setCourseTime(course, course.times)\r\n                }\r\n            })\r\n            .catch(err => {\r\n                alert(err.response.data.msg)\r\n                this.courses = []\r\n            })\r\n        },\r\n        resetSearch() {\r\n            axios.get('http://localhost:8081/student/course/verified')\r\n            .then(res => {\r\n                this.courses = res.data.data1\r\n                for(let course of this.courses) {\r\n                    course.courseTime = ''\r\n                    setCourseTime(course, course.times)\r\n                }\r\n            })\r\n            .catch(err => {\r\n                alert(err.response.data.msg)\r\n                this.courses = []\r\n            })\r\n        },\r\n        handleClick(tab, event) {\r\n            console.log(tab,event)\r\n            if(tab.props.name == 'available'){\r\n                axios.get('http://localhost:8081/student/course/verified')\r\n                .then(res => {\r\n                    this.courses = res.data.data1\r\n                    for(let course of this.courses) {\r\n                        // this.dialogTableVisible.push(false)\r\n                        course.courseTime = ''\r\n                        setCourseTime(course, course.times)\r\n                    }\r\n                })\r\n                .catch(err => {\r\n                    alert(err.response.data.msg)\r\n                    this.courses = []\r\n                })\r\n                console.log(1)\r\n            }\r\n            if(tab.props.name == 'selected') {\r\n                //axios获取已选课程\r\n                axios.get('http://localhost:8081/student/course/selected')\r\n                .then(res => {\r\n                    this.selectedCourses = res.data.data1\r\n                    for(let course of this.selectedCourses) {\r\n                        // this.dialogTableVisible.push(false)\r\n                        course.courseTime = ''\r\n                        setCourseTime(course, course.times)\r\n                    }\r\n                })\r\n                .catch(err => {\r\n                    alert(err.response.data.msg)\r\n                    this.selectedCourses = []\r\n                })\r\n                console.log(2)\r\n            }\r\n            if(tab.props.name == 'studied') {\r\n                axios.get('http://localhost:8081/student/course/studied')\r\n                .then(res => {\r\n                    this.studiedCourses = res.data.data1\r\n                    for(let course of this.studiedCourses) {\r\n                        // this.dialogTableVisible.push(false)\r\n                        course.courseTime = ''\r\n                        setCourseTime(course, course.times)\r\n                    }\r\n                })\r\n                .catch(err => {\r\n                    alert(err.response.data.msg)\r\n                    this.studiedCourses = []\r\n                })\r\n                console.log(3)\r\n            }\r\n        },\r\n        selectCourse(index) {\r\n            // this.selectedCourses.push(this.courses[index])\r\n            axios.post(\"http://localhost:8081/student/selection\", {courseId: this.courses[index].courseId})\r\n            .then(res => {\r\n                console.log(res)\r\n                this.courses.splice(index,1)\r\n                ElMessage({\r\n                    type: 'success',\r\n                    message: '选课成功！',\r\n                })\r\n            })\r\n            .catch(err => {\r\n                alert(err.response.data.msg)\r\n            })\r\n        },\r\n        quitCourse(index) {\r\n            // this.courses.push(this.selectedCourses[index])\r\n            // this.selectedCourses.splice(index,1) \r\n            axios.delete(\"http://localhost:8081/student/selection\",{data:{courseId: this.selectedCourses[index].courseId}})\r\n            .then(res => {\r\n                ElMessage({\r\n                    type: 'success',\r\n                    message: '退课成功',\r\n                })\r\n                this.selectedCourses.splice(index,1) \r\n                console.log(res)\r\n            })\r\n        },\r\n        filterYear(value, row) {\r\n            return row['year'] + row['semester'] === value\r\n        },\r\n        filterRoom(value, row) {\r\n            return row['building'] + row['roomNum'] === value\r\n        },\r\n        filterTime(value, row) {\r\n            for(let j = 0; j < row.times.length; j++) {\r\n                for(let k = 0; k < row.times[j].length; k++) {\r\n                    // let num = parseInt(data.times[j][k])+j*this.times.length\r\n                    // console.log(num)\r\n                    if(this.periods[j]+'第'+row.times[j][k]+'节课'==value) return true\r\n                }\r\n            }\r\n            return false\r\n        },\r\n        clearFilter() {\r\n            this.$refs['courses'].clearFilter()\r\n        },\r\n    },\r\n    async created() {\r\n        await axios.get('http://localhost:8081/user/curriculaVariable')\r\n        .then(res => {\r\n            this.courseStatus = res.data.data1\r\n            console.log(res)\r\n        })\r\n        .catch(error => {\r\n            console.dir(error)\r\n        })\r\n        if(this.courseStatus == '二轮选课开始' || this.courseStatus == '一轮选课开始') {\r\n            await axios.get('http://localhost:8081/student/course/verified')\r\n            .then(res => {\r\n                this.courses = res.data.data1\r\n                for(let i = 0; i < this.courses.length; i++) {\r\n                    this.courses[i].index = i\r\n                    this.courses[i].courseTime = ''\r\n                    setCourseTime(this.courses[i], this.courses[i].times)\r\n                }\r\n            })\r\n            .catch(err => {\r\n                alert(err.response.data.msg)\r\n                this.courses = []\r\n            })\r\n            await axios.get('http://localhost:8081/user/course/new')\r\n            .then(res => {\r\n                this.classroom = res.data.data2\r\n                for(let i = 0; i < this.classroom.length; i++) {\r\n                    this.classroom[i] = JSON.parse(JSON.stringify(this.classroom[i]).replace(/fullName/g,\"name\"))\r\n                    this.classroom[i] = JSON.parse(JSON.stringify(this.classroom[i]).replace(/roomNum/g,\"name\"))\r\n                    this.classroom[i] = JSON.parse(JSON.stringify(this.classroom[i]).replace(/abbrName/g,\"aka\"))\r\n                }\r\n                this.times = res.data.data3\r\n                // this.collegeData = res.data.data4\r\n                // for(let i = 0; i < this.collegeData.length; i++) {\r\n                //     if(this.collegeData[i].majors == []) {\r\n                //         this.collegeData[i]['disabled'] = true\r\n                //     }\r\n                // }\r\n            })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.search {\r\n    display: block;\r\n    float: right;\r\n    width: 200px;\r\n    margin-bottom: 50px;\r\n}\r\n.search .el-input__suffix {\r\n    cursor: pointer;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}