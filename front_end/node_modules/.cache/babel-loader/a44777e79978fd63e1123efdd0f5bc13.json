{"ast":null,"code":"import axios from 'axios';\nimport { validName, validPhone, validPassport, validEmail } from './jsComponents/CheckRules'; //格式检查\n\nexport default {\n  name: 'AdminControl',\n\n  data() {\n    return {\n      collegeData: [{\n        id: 1,\n        name: '计算机科学技术学院'\n      }, {\n        id: 2,\n        name: '生命科学学院'\n      }, {\n        id: 3,\n        name: '软件工程学院'\n      }],\n      majorData: [],\n      userData: {\n        number: null,\n        role: 'student',\n        name: '',\n        id: '',\n        phone: '',\n        email: '',\n        stu_id: null,\n        teach_id: null,\n        password: '123456',\n        major: '',\n        college: ''\n      },\n      rules: {\n        role: [{\n          required: true,\n          message: '请选择身份',\n          trigger: 'change'\n        }],\n        stu_id: [{\n          required: true,\n          message: '学号不能为空',\n          trigger: 'blur'\n        }, {\n          pattern: /^\\d{6,6}$/,\n          message: '学号为6位数字',\n          trigger: 'blur'\n        }, {\n          pattern: /^[0-1][0-9][0-9]*$|^2[0-2][0-9]*$/,\n          message: '学号必须为注册年份后两位开头的数字(小于22)'\n        }],\n        teach_id: [{\n          required: true,\n          message: '工号不能为空',\n          trigger: 'blur'\n        }, {\n          pattern: /^\\d{8,8}$/,\n          message: '工号为8位数字',\n          trigger: 'blur'\n        }, {\n          pattern: /^[0-1][0-9][0-9]*$|^2[0-2][0-9]*$/,\n          message: '工号必须为注册年份后两位开头的数字(小于22)'\n        }],\n        name: [{\n          required: true,\n          message: '姓名不能为空',\n          trigger: 'blur'\n        }, {\n          validator: validName,\n          trigger: ['blur', 'change']\n        }],\n        id: [{\n          required: true,\n          message: '身份证不能为空',\n          trigger: 'blur'\n        }, {\n          validator: validPassport,\n          trigger: 'blur'\n        }],\n        phone: [{\n          required: false,\n          trigger: ['blur', 'change']\n        }, {\n          validator: validPhone,\n          trigger: 'blur'\n        }],\n        email: [{\n          required: false,\n          trigger: 'blur'\n        }, {\n          validator: validEmail,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n\n  methods: {\n    submit() {\n      this.$refs['userData'].validate(valid => {\n        if (valid) {\n          if (this.userData.role == 'student') this.userData.number = this.userData.stu_id;\n          if (this.userData.role == 'teacher') this.userData.number = this.userData.teach_id;\n          console.log(this.userData); // axios.post('http://localhost:8081/register', null, {params:this.userData})\n\n          axios.post('http://localhost:8081/user/new', this.userData).then(function (resp) {\n            console.log(resp);\n            alert('提交成功');\n          }).catch(error => {\n            if (error.response.status == 421) {\n              if (this.userData.role == 'student') alert('学号已存在');else alert('工号已存在');\n              this.userData.stu_id = '';\n              this.userData.teach_id = '';\n            }\n\n            if (error.response.status == 420) {\n              alert('身份证已存在');\n              this.userData.id = '';\n            }\n\n            console.dir(error);\n          });\n        } else {\n          console.log('error ssssubmit');\n          return false;\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"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","names":["axios","validName","validPhone","validPassport","validEmail","name","data","collegeData","id","majorData","userData","number","role","phone","email","stu_id","teach_id","password","major","college","rules","required","message","trigger","pattern","validator","methods","submit","$refs","validate","valid","console","log","post","then","resp","alert","catch","error","response","status","dir"],"sourceRoot":"","sources":["D:\\fdu\\software_engineering\\Lab\\5-Lab\\front_end\\src\\components\\AdminControl.vue"],"sourcesContent":["<template>\r\n  <div class=\"admin\" style=\"margin:0px auto\">\r\n    <h1>信息录入</h1>\r\n    \r\n    <el-form id=\"admin_container\" ref=\"userData\" :model=\"userData\" :rules=\"rules\" autocomplete=\"on\"  text-align: center>\r\n      <el-form-item prop=\"role\">\r\n        <el-select v-model=\"userData.role\" placeholder=\"角色\">\r\n          <el-option label=\"学生\" value=\"student\"></el-option>\r\n          <el-option label=\"教师\" value=\"teacher\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n\r\n      <el-form-item class=\"college\" prop=\"college\">\r\n        <el-select v-model=\"userData.college\" placeholder=\"学院\">\r\n          <el-option :key=\"colleges.id\" :value=\"colleges.name\" :label=\"colleges.name\" v-for=\"colleges in collegeData\" ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n\r\n      <el-form-item class=\"major\" prop=\"major\" >\r\n        <el-select v-model=\"userData.major\" placeholder=\"专业\">\r\n          <el-option :key=\"colleges.id\" :value=\"colleges.name\" :label=\"colleges.name\" v-for=\"colleges in collegeData\" ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      \r\n      <el-form-item prop=\"name\">\r\n        <el-input\r\n          type=\"text\"\r\n          name=\"name\"\r\n          v-model=\"userData.name\"\r\n          placeholder=\"姓名\"\r\n        />\r\n      </el-form-item> \r\n\r\n      <el-form-item v-if=\"userData.role==='student'\" prop=\"stu_id\">\r\n        <el-input\r\n          type=\"text\"\r\n          name=\"stu_id\"\r\n          v-model.number=\"userData.stu_id\"\r\n          placeholder=\"学号\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item v-if=\"userData.role==='teacher'\" prop=\"teach_id\">\r\n        <el-input\r\n          type=\"text\"\r\n          name=\"teach_id\"\r\n          v-model.number=\"userData.teach_id\"\r\n          placeholder=\"工号\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item prop=\"id\">\r\n        <el-input\r\n          name=\"id\"\r\n          v-model=\"userData.id\"\r\n          placeholder=\"身份证号\"\r\n          type=\"text\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item prop=\"phone\">\r\n        <el-input\r\n          type=\"text\"\r\n          name=\"phone\"\r\n          v-model=\"userData.phone\"\r\n          placeholder=\"手机号\"\r\n        />\r\n      </el-form-item> \r\n\r\n      <el-form-item prop=\"email\">\r\n        <el-input\r\n          type=\"text\"\r\n          name=\"email\"\r\n          v-model=\"userData.email\"\r\n          placeholder=\"邮箱\"\r\n        />\r\n      </el-form-item>\r\n\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submit\">提交</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport {validName,validPhone,validPassport,validEmail} from './jsComponents/CheckRules'//格式检查\r\n\r\nexport default {\r\n\r\n  name: 'AdminControl',\r\n\r\n  data(){\r\n    return {\r\n      collegeData: [\r\n        {id: 1, name: '计算机科学技术学院'},\r\n        {id: 2, name: '生命科学学院'},\r\n        {id: 3, name: '软件工程学院'},\r\n      ],\r\n      majorData: [\r\n\r\n      ],\r\n      userData: {\r\n        number: null,\r\n        role: 'student',\r\n        name: '',\r\n        id: '',\r\n        phone: '',\r\n        email: '',\r\n        stu_id: null,\r\n        teach_id: null,\r\n        password: '123456',\r\n        major: '',\r\n        college: '',\r\n      },\r\n      rules: {\r\n        role: [{required: true, message: '请选择身份', trigger: 'change'}],\r\n        stu_id: [{required: true, message: '学号不能为空', trigger: 'blur'},\r\n                 {pattern: /^\\d{6,6}$/, message: '学号为6位数字', trigger: 'blur'},\r\n                 {pattern: /^[0-1][0-9][0-9]*$|^2[0-2][0-9]*$/, message: '学号必须为注册年份后两位开头的数字(小于22)'}],\r\n        teach_id: [{required: true, message: '工号不能为空', trigger: 'blur'},\r\n                 {pattern: /^\\d{8,8}$/, message: '工号为8位数字', trigger: 'blur'},\r\n                 {pattern: /^[0-1][0-9][0-9]*$|^2[0-2][0-9]*$/, message: '工号必须为注册年份后两位开头的数字(小于22)'}],\r\n        name: [{required: true, message: '姓名不能为空', trigger: 'blur'},\r\n               {validator: validName, trigger: ['blur', 'change']}],\r\n        id: [{ required: true, message: '身份证不能为空', trigger: 'blur'},\r\n                   { validator: validPassport, trigger: 'blur' }],\r\n        phone: [{required: false, trigger: ['blur', 'change']},\r\n                {validator: validPhone, trigger: 'blur'}],\r\n        email: [{required: false, trigger: 'blur'},\r\n                {validator: validEmail, trigger: 'blur'}],\r\n      }\r\n    }\r\n  },\r\n  methods:{\r\n    submit(){\r\n      this.$refs['userData'].validate(valid => {\r\n        if(valid){\r\n          if(this.userData.role == 'student')\r\n            this.userData.number = this.userData.stu_id\r\n          if(this.userData.role == 'teacher')\r\n            this.userData.number = this.userData.teach_id\r\n          console.log(this.userData)\r\n          // axios.post('http://localhost:8081/register', null, {params:this.userData})\r\n          axios.post('http://localhost:8081/user/new', this.userData)\r\n          .then(function(resp){\r\n            console.log(resp)\r\n            alert('提交成功')\r\n              \r\n          }).catch(error => {\r\n            if(error.response.status == 421){\r\n              if(this.userData.role == 'student')\r\n                alert('学号已存在')\r\n              else\r\n                alert('工号已存在')\r\n              this.userData.stu_id = ''\r\n              this.userData.teach_id = ''\r\n            }\r\n            if(error.response.status == 420){\r\n              alert('身份证已存在');\r\n              this.userData.id = ''\r\n            }\r\n            console.dir(error);\r\n          })\r\n        }\r\n        else{\r\n          console.log('error ssssubmit');\r\n          return false\r\n        }\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n.admin{\r\n  position: absolute;\r\n  width: 500px;\r\n  height: 300px;\r\n  margin: auto;\r\n  left: 0;\r\n  right: 0;\r\n}\r\n#container {\r\n  border-radius: 15px;\r\n  margin: 0px auto;\r\n  width: 500px;\r\n  padding: 35px 35px;\r\n  background: #fff;\r\n}\r\n\r\nh3 {\r\n  margin: 40px 0 0;\r\n}\r\n\r\n.college {\r\n  float:left;\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}