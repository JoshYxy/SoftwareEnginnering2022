{"ast":null,"code":"import axios from 'axios';\nimport { ElMessage, ElMessageBox } from 'element-plus';\nexport default {\n  data() {\n    return {\n      courseOpen: true,\n      onDeleteAll: false,\n      //是否有card进入删除状态\n      onDelete: [false],\n      //特定card是否进入删除教室状态\n      checkGroup: [],\n      startTime: ['08:00', '10:00'],\n      endTime: ['08:40', '11:00'],\n      newRoom: '',\n      //存放input输入的教室号\n      newClassroom: {\n        name: '',\n        aka: '',\n        room: []\n      },\n      //存档select选择的教学楼\n      classroom: [{\n        name: '第三教学楼',\n        aka: 'H3',\n        room: ['301', '402']\n      }, {\n        name: '光华楼西辅楼',\n        aka: 'HGX',\n        room: ['201', '502']\n      }],\n      //存放所有的教学楼及教室号信息\n      buildings: [{\n        id: 1,\n        name: '第三教学楼',\n        aka: 'H3'\n      }, {\n        id: 2,\n        name: '第四教学楼',\n        aka: 'H4'\n      }, {\n        id: 3,\n        name: '光华楼西辅楼',\n        aka: 'HGX'\n      }, {\n        id: 4,\n        name: '第五教学楼',\n        aka: 'H5'\n      }, {\n        id: 5,\n        name: '第六教学楼',\n        aka: 'H6'\n      }]\n    };\n  },\n\n  methods: {\n    async courseChange() {\n      var flag = false;\n      await ElMessageBox.confirm('是否更改选课状态', '请确认', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        axios.post('http://localhost:8081/affair/curriculaVariable', null, {\n          params: {\n            choice: this.courseOpen\n          }\n        });\n        ElMessage({\n          type: 'success',\n          message: '修改完成'\n        });\n        flag = true;\n      }).catch(() => {\n        flag = false;\n      });\n      return flag;\n    },\n\n    deleteCourse(index) {\n      this.startTime.splice(index, 1);\n      this.endTime.splice(index, 1);\n    },\n\n    addCourse(index) {\n      this.startTime.splice(index + 1, 0, '');\n      this.endTime.splice(index + 1, 0, '');\n    },\n\n    addClassroom() {\n      if (this.newRoom === '') {\n        alert('教室号不能为空');\n        return;\n      }\n\n      var i;\n      i = this.classroom.findIndex(building => building.name == this.newClassroom.name); //寻找classroom已有的教学楼中是否有newClassroom中的教学楼 \n\n      if (i >= 0) {\n        if (this.classroom[i].room.indexOf(this.newRoom) > -1) {\n          alert('教室已存在，请勿重复添加');\n          this.newRoom = '';\n          return;\n        }\n\n        axios.post('http://localhost:8081/affair/room/new', {\n          building: this.newClassroom.aka,\n          roomNum: this.newRoom\n        }).then(res => {\n          console.log(res);\n          this.classroom[i].room.push(this.newRoom);\n          this.classroom[i].room.sort((a, b) => {\n            if (a.length < b.length) return -1;else if (a.length > b.length) return 1;else return a.localeCompare(b);\n          }); //将教室号排序\n        });\n      } else {\n        axios.post('http://localhost:8081/affair/room/new', {\n          building: this.newClassroom.aka,\n          roomNum: this.newRoom\n        }).then(res => {\n          console.log(res);\n          this.newClassroom.room = [];\n          this.newClassroom.room.push(this.newRoom);\n          this.classroom.push(this.newClassroom);\n        });\n      }\n\n      this.newRoom = '';\n    },\n\n    checkDelete(index) {\n      ElMessageBox.confirm('是否删除教学楼‘' + this.classroom[index].name + '’内的全部教室', 'Warning', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.deleteBuilding(index);\n        ElMessage({\n          type: 'success',\n          message: '删除成功'\n        });\n      }).catch(() => {\n        ElMessage({\n          type: 'info',\n          message: '删除取消'\n        });\n      });\n    },\n\n    deleteBuilding(index) {\n      axios.delete('http://localhost:8081/affair/building/rooms');\n      this.classroom.splice(index, 1);\n    },\n\n    openDelete(index) {\n      this.onDeleteAll = true;\n      this.onDelete[index] = true;\n      this.checkGroup = [];\n\n      for (let i in this.classroom[index].room) {\n        this.checkGroup.push({\n          name: this.classroom[index].room[i],\n          status: false\n        });\n      }\n\n      console.log(this.checkGroup);\n    },\n\n    async submitDelete(index) {\n      this.onDelete[index] = false;\n      this.onDeleteAll = false;\n\n      for (let i = 0; i < this.checkGroup.length; i++) {\n        if (this.checkGroup[i].status) {\n          await axios.delete('http://localhost:8081/affair/room', {\n            building: this.classroom[index].aka,\n            roomNum: this.classroom[index].room[i]\n          }).then(res => {\n            console.log(res);\n            this.classroom[index].room.splice(i, 1);\n            this.checkGroup.splice(i, 1);\n          });\n          i = i - 1;\n        }\n      }\n\n      this.checkGroup = [];\n    },\n\n    cancelDelete(index) {\n      this.onDelete[index] = false;\n      this.onDeleteAll = false;\n      this.checkGroup = [];\n    },\n\n    test(index) {\n      // console.log(this.startTime)\n      console.log(index);\n      console.log(this.newClassroom);\n      console.log(this.classroom);\n    },\n\n    submitCourse() {\n      let times = [];\n\n      for (let i = 0; i < this.startTime.length; i++) {\n        if (this.startTime[i] == '' || this.endTime[i] == '') {\n          alert('请填写完所有上课时间后提交');\n          return;\n        }\n\n        times.push({\n          name: '第' + i + '节',\n          startTime: this.startTime[i],\n          endTime: this.endTime[i]\n        });\n      }\n\n      axios.post('http://localhost:8081/affair/times', times);\n    }\n\n  },\n\n  async created() {\n    //获取选课状态\n    axios.get('http://localhost:8081/curriculaVariable').then(res => {\n      this.courseOpen = res.data.data;\n    }); //获取所有教学楼\n\n    axios.get('http://localhost:8081/affair/building').then(res => {\n      this.buildings = res.data.data;\n\n      for (let i = 0; i < this.buildings.length; i++) {\n        this.buildings[i] = JSON.parse(JSON.stringify(this.buildings[i]).replace(/fullName/g, \"name\"));\n        this.buildings[i] = JSON.parse(JSON.stringify(this.buildings[i]).replace(/abbrName/g, \"aka\"));\n      }\n    });\n    await axios.get('http://localhost:8081/affair').then(res => {\n      console.log(res); //获取教室信息\n\n      let classrooms = res.data.data1;\n      this.classroom = [];\n\n      for (let i = 0; i < classrooms.length; i++) {\n        this.classroom.push({\n          name: classrooms[i].fullName,\n          aka: classrooms[i].abbrName,\n          room: []\n        });\n\n        for (let j = 0; j < classrooms[i].room.length; j++) {\n          this.classroom[i].room.push(classrooms[i].room[j].roomNum);\n        }\n      } //获取上课时间信息\n\n\n      let classTime = res.data.data2;\n      this.startTime = [];\n      this.endTime = [];\n\n      for (let i = 0; i < classTime.length; i++) {\n        this.startTime.push(classTime[i].startTime);\n        this.endTime.push(classTime[i].endTime);\n      }\n    });\n  }\n\n};","map":{"version":3,"mappings":"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","names":["axios","ElMessage","ElMessageBox","data","courseOpen","onDeleteAll","onDelete","checkGroup","startTime","endTime","newRoom","newClassroom","name","aka","room","classroom","buildings","id","methods","courseChange","flag","confirm","confirmButtonText","cancelButtonText","type","then","post","params","choice","message","catch","deleteCourse","index","splice","addCourse","addClassroom","alert","i","findIndex","building","indexOf","roomNum","res","console","log","push","sort","a","b","length","localeCompare","checkDelete","deleteBuilding","delete","openDelete","status","submitDelete","cancelDelete","test","submitCourse","times","created","get","JSON","parse","stringify","replace","classrooms","data1","fullName","abbrName","j","classTime","data2"],"sourceRoot":"","sources":["D:\\fdu\\software_engineering\\Lab\\5-Lab\\front_end\\src\\components\\course\\EduMaintenance.vue"],"sourcesContent":["<template>\r\n    <div >\r\n        <h2>选课状态设置</h2>\r\n        <el-switch    \r\n            v-model=\"courseOpen\"\r\n            active-text=\"开始选课\"\r\n            inactive-text=\"停止选课\" \r\n            :before-change=\"courseChange\"/>\r\n        <h2>教学时间设置</h2>\r\n        <el-button @click=\"addCourse(-1)\">增加第一节课</el-button>\r\n        <el-button type='primary' @click=\"submitCourse\">提交修改</el-button>\r\n        <div class=\"course-container\" v-for=\"(item, index) in startTime\" :key=\"item.id\">\r\n            <span class=\"course-left\">第{{index+1}}节课</span>\r\n            <div class=\"course-right\">\r\n                <el-time-select\r\n                    v-model=\"startTime[index]\"\r\n                    :min-time=\"index==0?'7:55':(endTime[index-1]?endTime[index-1]:'8:00')\"\r\n                    :max-time=\"endTime[index]\"\r\n                    :start=\"index==0?'8:00':(endTime[index-1]?endTime[index-1]:'8:00')\"\r\n                    placeholder=\"上课时间\"\r\n                    step=\"00:05\"\r\n                    end=\"22:30\"\r\n                    />-\r\n                <el-time-select\r\n                    v-model=\"endTime[index]\"\r\n                    :min-time=\"startTime[index]\"\r\n                    :max-time=\"startTime[index+1]\"\r\n                    :start=\"startTime[index]?startTime[index]:'8:00'\"\r\n                    placeholder=\"下课时间\"\r\n                    step=\"00:05\"\r\n                    end=\"23:30\"\r\n                    />\r\n                <el-button @click=\"addCourse(index)\">增加一节课</el-button>\r\n                <el-button @click=\"deleteCourse(index)\">删除这节课</el-button>\r\n                <el-button @click=\"test(index)\">test</el-button>\r\n            </div>\r\n        </div>\r\n        <div class=\"class-container\">\r\n            <h2>上课教室设置</h2>\r\n            <el-input\r\n                v-model=\"newRoom\"\r\n                placeholder=\"教室号\"\r\n                class=\"input-with-select\"\r\n                \r\n                >\r\n                <template #prepend>\r\n                    <el-select v-model=\"newClassroom\" placeholder=\"教学楼\" value-key=\"name\" style=\"width: 150px\">\r\n                        <el-option v-for=\"(building) in buildings\" :key=\"building.name\" :value=\"building\" :label=\"building.name\"  />\r\n                    </el-select>\r\n                </template>\r\n                <template #append>\r\n                    <section style=\"width: 150px\"> {{newClassroom.aka}}{{newRoom}} </section>\r\n                    \r\n                </template>\r\n            </el-input>\r\n            <el-button @keydown=\"addClassroom\" @click=\"addClassroom\">添加新教室</el-button>\r\n        </div>\r\n        <div class=\"classroom-container\">\r\n            <el-card \r\n                class=\"box-card\"\r\n                v-for=\"(building, index) in classroom\"\r\n                :key=\"building.name\"\r\n                >\r\n                <template #header>\r\n                <div class=\"card-header\">\r\n                    <span>{{building.name}}</span>\r\n                    <el-button class=\"button\" type=\"text\" v-if=\"!onDeleteAll\" @click=\"checkDelete(index)\">删除该教学楼</el-button>\r\n                </div>\r\n                </template>\r\n                <el-scrollbar height=\"200px\" class=\"card-item-container\"> \r\n                    <el-button v-if=\"!onDelete[index] && !onDeleteAll\" class=\"button\" type=\"text\" @click=\"openDelete(index)\">删除教室</el-button>\r\n                    <el-button v-if=\"onDelete[index]\" class=\"button2\" type=\"text\" @click=\"submitDelete(index)\">确认删除选中教室</el-button>\r\n                    <el-button v-if=\"onDelete[index]\" class=\"button2\" type=\"text\" @click=\"cancelDelete(index)\">取消删除</el-button>\r\n                    <div class=\"hold-place\" v-if=\"onDeleteAll && !onDelete[index]\"> </div>\r\n                    <div v-if=\"!onDelete[index]\" class=\"card-item-div-container\">\r\n                        <div class=\"card-item\" v-for=\"room in building.room\" :key=\"room\">{{building.aka}}{{room}}</div>\r\n                    </div> \r\n                    <div v-for=\"(room,index2) in checkGroup\" \r\n                            :key=\"room.name\" \r\n                            class=\"card-item\" >\r\n                        <el-checkbox \r\n                            v-if=\"onDelete[index]\"\r\n                            v-model=\"checkGroup[index2].status\" \r\n                            :label='building.aka+checkGroup[index2].name' \r\n                            />\r\n                    </div>\r\n                </el-scrollbar>\r\n\r\n            </el-card>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport { ElMessage, ElMessageBox } from 'element-plus'\r\nexport default {\r\n    data() {\r\n        return {\r\n\r\n            courseOpen: true,\r\n            onDeleteAll: false,//是否有card进入删除状态\r\n            onDelete: [false],//特定card是否进入删除教室状态\r\n            checkGroup: [],\r\n            startTime:['08:00','10:00'],\r\n            endTime:['08:40','11:00'],\r\n            newRoom:'',//存放input输入的教室号\r\n            newClassroom: {\r\n                name: '',\r\n                aka: '',\r\n                room: [],\r\n            },//存档select选择的教学楼\r\n            classroom: [\r\n                {\r\n                    name: '第三教学楼',\r\n                    aka: 'H3',\r\n                    room: [\r\n                        '301','402'\r\n                    ]\r\n                },\r\n                {\r\n                    name: '光华楼西辅楼',\r\n                    aka: 'HGX',\r\n                    room: [\r\n                        '201','502'\r\n                    ]\r\n                },\r\n            ],//存放所有的教学楼及教室号信息\r\n            buildings: [\r\n                {id:1,name: '第三教学楼', aka: 'H3'},\r\n                {id:2,name: '第四教学楼', aka: 'H4'},\r\n                {id:3,name: '光华楼西辅楼', aka: 'HGX'},\r\n                {id:4,name: '第五教学楼', aka: 'H5'},\r\n                {id:5,name: '第六教学楼', aka: 'H6'},\r\n            ]\r\n        }\r\n    },\r\n    methods: {\r\n        async courseChange() {\r\n            var flag = false\r\n            await ElMessageBox.confirm(\r\n                '是否更改选课状态',\r\n                '请确认',\r\n                {\r\n                confirmButtonText: '确认',\r\n                cancelButtonText: '取消',\r\n                type: 'warning',\r\n                }\r\n            )\r\n                .then(() => {\r\n                    axios.post('http://localhost:8081/affair/curriculaVariable',null,{params:{choice:this.courseOpen}})\r\n                    ElMessage({\r\n                        type: 'success',\r\n                        message: '修改完成',\r\n                    })\r\n                    flag = true\r\n                })\r\n                .catch(() => {\r\n                    flag = false\r\n                })\r\n            return flag\r\n        },\r\n        deleteCourse(index) {\r\n            this.startTime.splice(index,1)\r\n            this.endTime.splice(index,1)\r\n        },\r\n        addCourse(index) {\r\n            this.startTime.splice(index+1,0,'')\r\n            this.endTime.splice(index+1,0,'')\r\n        },\r\n\r\n        addClassroom() {\r\n            if(this.newRoom === '') {\r\n                alert('教室号不能为空')\r\n                return\r\n            }\r\n            var i;\r\n            i = this.classroom.findIndex((building) => building.name == this.newClassroom.name)//寻找classroom已有的教学楼中是否有newClassroom中的教学楼 \r\n            if(i >= 0) {\r\n                if(this.classroom[i].room.indexOf(this.newRoom) > -1) {\r\n                    alert('教室已存在，请勿重复添加')\r\n                    this.newRoom = ''\r\n                    return\r\n                }\r\n                axios.post('http://localhost:8081/affair/room/new', {building: this.newClassroom.aka, roomNum: this.newRoom})\r\n                .then(res => {\r\n                    console.log(res)\r\n                    this.classroom[i].room.push(this.newRoom) \r\n                    this.classroom[i].room.sort((a, b) => {\r\n                        if(a.length < b.length) return -1\r\n                        else if(a.length > b.length) return 1\r\n                        else return a.localeCompare(b)   \r\n                    }) //将教室号排序\r\n                })\r\n                \r\n            } \r\n            else {\r\n                axios.post('http://localhost:8081/affair/room/new', {building: this.newClassroom.aka, roomNum: this.newRoom})\r\n                .then(res => {\r\n                    console.log(res)\r\n                    this.newClassroom.room=[]\r\n                    this.newClassroom.room.push(this.newRoom)\r\n                    this.classroom.push(this.newClassroom)\r\n                })\r\n\r\n            }\r\n            this.newRoom = ''\r\n        },\r\n        checkDelete(index) {\r\n            ElMessageBox.confirm(\r\n                '是否删除教学楼‘' + this.classroom[index].name+'’内的全部教室',\r\n                'Warning',\r\n                {\r\n                    confirmButtonText: '确认',\r\n                    cancelButtonText: '取消',\r\n                    type: 'warning',\r\n                }\r\n            )\r\n            .then(() => {\r\n                this.deleteBuilding(index)\r\n                ElMessage({\r\n                    type: 'success',\r\n                    message: '删除成功',\r\n                })\r\n                })\r\n            .catch(() => {\r\n                ElMessage({\r\n                    type: 'info',\r\n                    message: '删除取消',\r\n                })\r\n            })\r\n        },\r\n        deleteBuilding(index) {\r\n            axios.delete('http://localhost:8081/affair/building/rooms', )\r\n            this.classroom.splice(index, 1)\r\n        },\r\n        openDelete(index) {\r\n            this.onDeleteAll = true\r\n            this.onDelete[index] = true\r\n            this.checkGroup = []\r\n            for(let i in this.classroom[index].room) {\r\n                this.checkGroup.push({name:this.classroom[index].room[i], status: false})\r\n            }\r\n            console.log(this.checkGroup)\r\n            \r\n        },\r\n        async submitDelete(index) {\r\n            this.onDelete[index] = false\r\n            this.onDeleteAll = false\r\n            for(let i = 0; i < this.checkGroup.length; i++) {\r\n                if(this.checkGroup[i].status) {\r\n                    await axios.delete('http://localhost:8081/affair/room', {building: this.classroom[index].aka, roomNum: this.classroom[index].room[i]})\r\n                    .then(res => {\r\n                        console.log(res)\r\n                        this.classroom[index].room.splice(i, 1)\r\n                        this.checkGroup.splice(i, 1)\r\n                    })\r\n\r\n                    i=i-1\r\n                }\r\n            }\r\n            this.checkGroup = []\r\n        },\r\n        cancelDelete(index) {\r\n            this.onDelete[index] = false\r\n            this.onDeleteAll = false\r\n            this.checkGroup = [] \r\n        },\r\n        test(index) {\r\n            // console.log(this.startTime)\r\n            console.log(index)\r\n            console.log(this.newClassroom)\r\n            console.log(this.classroom)\r\n        },\r\n        submitCourse() {\r\n            let times = []\r\n            for(let i = 0; i < this.startTime.length; i++) {\r\n                if(this.startTime[i] == '' || this.endTime[i] == '') {\r\n                    alert('请填写完所有上课时间后提交')\r\n                    return\r\n                }\r\n                times.push({name: '第'+i+'节', startTime: this.startTime[i], endTime: this.endTime[i]})\r\n            }\r\n            axios.post('http://localhost:8081/affair/times', times)\r\n        }\r\n    },\r\n    async created() {\r\n         //获取选课状态\r\n        axios.get('http://localhost:8081/curriculaVariable')\r\n        .then(res => {\r\n            this.courseOpen = res.data.data\r\n        })\r\n        //获取所有教学楼\r\n        axios.get('http://localhost:8081/affair/building')\r\n        .then(res => {\r\n            this.buildings = res.data.data\r\n            for(let i = 0; i < this.buildings.length; i++) {\r\n                this.buildings[i] = JSON.parse(JSON.stringify(this.buildings[i]).replace(/fullName/g,\"name\"))\r\n                this.buildings[i] = JSON.parse(JSON.stringify(this.buildings[i]).replace(/abbrName/g,\"aka\"))\r\n            }\r\n        })\r\n        await axios.get('http://localhost:8081/affair')\r\n        .then(res => {\r\n            console.log(res)\r\n            //获取教室信息\r\n            let classrooms = res.data.data1\r\n            this.classroom = []\r\n            for(let i = 0; i < classrooms.length; i++) {\r\n                this.classroom.push({name:classrooms[i].fullName, aka:classrooms[i].abbrName, room:[]})\r\n                for(let j = 0; j < classrooms[i].room.length; j++) {\r\n                    this.classroom[i].room.push(classrooms[i].room[j].roomNum)\r\n                }\r\n            }\r\n            //获取上课时间信息\r\n            let classTime = res.data.data2\r\n            this.startTime = []\r\n            this.endTime = []\r\n            for(let i = 0; i < classTime.length; i++) {\r\n                this.startTime.push(classTime[i].startTime)\r\n                this.endTime.push(classTime[i].endTime)\r\n            }\r\n           \r\n            \r\n        })\r\n    }\r\n}\r\n</script>\r\n\r\n<style >\r\n.el-card__body {\r\n    padding-top: 10px;\r\n}\r\n.card-item-container .el-scrollbar__view {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content:space-between;\r\n}\r\n.card-item-div-container {\r\n    width: 236px;\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content:space-between;\r\n\r\n}\r\n.card-item-container .button{\r\n    width: 100%;\r\n}\r\n.card-item-container .button2{\r\n    width: 50%;\r\n    margin: 0px;\r\n\r\n}\r\n.card-item {\r\n    font-size: 16px;\r\n    width: 50%;\r\n}\r\n.card-item .el-checkbox__label {\r\n    font-size: 16px;\r\n}\r\n.card-item-container .hold-place {\r\n    width: 100%;\r\n    height: 14px;\r\n    padding: 8px;\r\n    margin: 1px;\r\n}\r\n.classroom-container {\r\n    width: 1200px;\r\n    margin: auto;\r\n    display: flex;\r\n    flex-wrap:wrap;\r\n    justify-content:flex-start;\r\n}\r\n.card-header {\r\n    display: flex;\r\n    justify-content: space-between;\r\n    align-items: center;\r\n}\r\n\r\n.text {\r\n    font-size: 14px;\r\n}\r\n.box-card {\r\n    margin: 0.9%;\r\n    height: 300px;\r\n\r\n    width: 23%;\r\n}\r\n\r\n.course-container {\r\n    display: flex;\r\n    margin: auto;\r\n    justify-content:center\r\n}\r\n.course-left{\r\n    flex: 0;\r\n    margin-left:200px;\r\n    min-width: 100px;\r\n    padding-right:auto;\r\n    /* padding-bottom:20px; */\r\n    padding-left: auto;\r\n    margin:10px;\r\n    text-align:right;\r\n}\r\n.course-right{\r\n    max-width:800px;\r\n    flex: 1;\r\n}\r\n.class-container {\r\n    width: 600px;\r\n    margin: auto;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}